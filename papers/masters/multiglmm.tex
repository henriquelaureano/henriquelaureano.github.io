\documentclass[a4paper,12pt]{article}
\usepackage[top=2.5cm,bottom=2.5cm,left=2.5cm,right=2.5cm]{geometry}
%% \usepackage[brazil,brazilian]{babel}
\usepackage{amsmath, nccmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{multirow}
\usepackage{natbib}
\usepackage[colorlinks,citecolor=blue,urlcolor=blue]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}  
\usepackage{float}
\usepackage{pdflscape} % horizontal page
\usepackage{tabularx}
\usepackage[english,vlined,ruled]{algorithm2e}
\usepackage{booktabs}
\usepackage{tikz}
\usetikzlibrary{positioning,shapes,arrows}
\usepackage{adjustbox}
\input{tikzit.sty}

\title{
  
  Modeling the cumulative incidence function of clustered competing
  risks data: a multinomial GLMM approach

}
\author{
  Henrique Aparecido Laureano\thanks{
    Laboratory of Statistics and Goeinformation,
    Departament of Statistics,
    Paran\'{a} Federal University, Curitiba, Brazil.
    E-mail: laureano@ufpr.br
  }~
  Wagner Hugo Bonat$^\ast$}
 
\begin{document}
\maketitle

\begin{abstract}

  Clustered competing risks data are a complex failure time data
  scheme. Its main characteristics are the cluster structure, which
  implies a latent within-cluster dependence between its elements, and
  its multiple variables competing to be the one responsible for the
  occurrence of an event, the failure. To handle this kind of data, we
  propose a full likelihood approach, based on a generalized linear
  mixed model instead a usual complex frailty model. We model the
  competing causes in the probability scale, in terms of the cumulative
  incidence function (CIF). A multinomial distribution is assumed for
  the competing causes and censorship, conditioned on the latent
  effects. The latent effects are accommodated via a multivariate
  Gaussian distribution. The CIF is specified as the product of an
  instantaneous risk level function with a failure time trajectory level
  function. The estimation procedure is performed through the R package
  TMB (Template Model Builder), an \texttt{C++} based framework with
  efficient Laplace approximation and automatic differentiation
  routines. A large simulation study is performed, based on different
  latent structure formulations. The model presents to be of difficult
  estimation, with our results converging to a latent structure where
  the risk and failure time trajectory levels are correlated.

\end{abstract}

\begin{flushleft}
 \textbf{Keywords}: 
 Clustered competing risks;
 Within-cluster dependence;
 Multinomial generalized linear mixed model (GLMM);
 TMB: Template Model Builder;
 Laplace approximation;
 Automatic differentiation (AD).                    
\end{flushleft}

\section{Introduction}

Regression models are the main statistical tool for investigating the
relationship between a response variable and a set of explanatory
variables. When the response is the time until the occurrence of some
event, we are in the yard of failure time data with its regression
models being called survival models \citep{kalb&prentice}, with the word
\textit{survival} meaning that the modeling focus is the survival
experience. We could be interested in the occurrence of an event for
multiple causes or even in systematic occurrences, having then multiple
survival experiences to be modeled. These possibilities imply different
failure time data designs. They can be of three classes, as schematized
in Figure \ref{fig:failuretimedata}.

\begin{figure}[H]
 \centering
 \scalebox{0.85}{
  \begin{tikzpicture}
   \begin{pgfonlayer}{nodelayer}
    \node [style=circle,draw=black,fill=white] (2) at (-17.5, 5.5) {0};
    \node [style=circle,draw=black,fill=white] (3) at (-13.5, 5.5) {1};
    \node [style=circle,draw=black,fill=white] (7) at (-7.5, 5.5) {1};
    \node [style=circle,draw=black,fill=white] (9) at (-7.5, 4.5) {2};
    \node [style=none] (11) at (-7.5, 3.5) {$\vdots$};
    \node [style=circle,draw=black,fill=white] (12) at (-7.5, 2.5) {$m$};
    \node [style=circle,draw=black,fill=white] (14) at (-12.25, 4) {0};
    \node [style=circle,draw=black,fill=white] (22) at (-6, 3.5) {0};
    \node [style=circle,draw=black,fill=white] (23) at (-2, 3.5) {2};
    \node [style=circle,draw=black,fill=white] (25) at (-4, 5.5) {1};
    \node [style=none] (27) at (-17, 5.5) {};
    \node [style=none] (28) at (-14, 5.5) {};
    \node [style=none] (29) at (-11.75, 4.25) {};
    \node [style=none] (30) at (-8, 5.5) {};
    \node [style=none] (31) at (-8, 4.5) {};
    \node [style=none] (32) at (-8, 2.5) {};
    \node [style=none] (33) at (-5.5, 3.5) {};
    \node [style=none] (34) at (-4.5, 5.25) {};
    \node [style=none] (35) at (-2.5, 3.5) {};
    \node [style=none] (36) at (-11.75, 4) {};
    \node [style=none] (37) at (-11.75, 3.75) {};
    \node [style=none] (38) at (-5.5, 3.75) {};
    \node [style=none] (39) at (-2.5, 3.75) {};
    \node [style=none] (40) at (-3.5, 5.25) {};
    \node [style=none] (44) at (-15.5, 6.75) {{\large
                                               Failure time process}};
    \node [style=none] (45) at (-10, 6.75) {{\large
                                             Competing risks process}};
    \node [style=none] (47) at (-4, 6.75) {{\large Multistate process}};
   \end{pgfonlayer}
   \begin{pgfonlayer}{edgelayer}
	\draw [style=1side] (27.center) to (28.center);
	\draw [style=1side] (37.center) to (32.center);
	\draw [style=1side] (40.center) to (39.center);
	\draw [style=1side] (33.center) to (35.center);
	\draw [style=2side] (38.center) to (34.center);
	\draw [style=1side] (36.center) to (31.center);
	\draw [style=1side] (29.center) to (30.center);
   \end{pgfonlayer}
  \end{tikzpicture}
 }
 \caption{Illustration of failure time designs.}
 \label{fig:failuretimedata}
\end{figure}

The first two are special cases of the last, a multistate process. The
special cases are characterized by the presence of only absorbent
states, besides the initial state 0. A multistate process is
characterized by the presence of at least one intermediate state. In
this work, our focus is on the competing risks process, more
specifically, its clustered version. This means that we have groups of
elements sharing some non-observed latent dependence structure.

In survival analysis, the survival experiences are usually modeled in
the hazard (failure rate) scale, and when the latent within-cluster
dependence is accommodated we have the so-called frailty models.

A less usual scale but convenient when dealing with competing risks
process is the probability scale.

The class of generalized linear models~(GLMs)~\citep{GLM72}
is probably the most popular statistical modelling framework to deal
with Gaussian and non-Gaussian outcomes. Despite its flexibility, the
GLMs are not suitable for . In general, .

The analysis of is generally performed by the . Besides that, other
. Some examples are the . Additionally, .

Although these models are useful in many applications, they are usually
limited to analyze independent data. In the case of longitudinal data,
it is essential that the regression model take into account the
longitudinal and/or grouped data structure. According to \cite{}
longitudinal data are repeated measures evaluated on the same subjects
over time, that are potentially correlated. Dependent data can also
arises in studies with block designs, spatial and multilevel data. For
the analysis of such data several methods have been proposed over the
last four decades.

\cite{laird82} proposed the random effects regression models for
longitudinal data analysis. \cite{breslow93} presented the generalized
linear mixed models~(GLMMs) for the analysis of non-Gaussian
outcomes. \cite{gcmr} developed a class of marginal models for modelling
dependence structures in the analysis of longitudinal data, time series
and spatial based on Gaussian copula models.

The main goal of this study is to propose the . In this paper, we will
investigate the as an alternative to . R \citep{R21} package
\texttt{TMB} \citep{TMb}.

The main contributions of this article are: (i) introducing the unit
gamma distribution into the GLMMs framework; (ii) performing a extensive
simulation study to check the properties of the the maximum likelihood
estimator to deal with longitudinal continuous bounded outcomes; (iii)
applying the proposed model in two data sets from different fields of
application; (iv) providing R code and \texttt{C++} implementation for
the unit gamma mixed models.

The work are organized as follows. Finally, the main contributions of
the article are discussed in Section .

\section{multiGLMM: a multinomial GLMM for clustered competing risks data}
\label{model}

\begin{figure}[H]
 \centering \includegraphics[width=\textwidth]{pics/cifcoefs-1.png}
 \caption{ILLUSTRATION OF COEFFICIENT BEHAVIORS FOR A GIVEN CUMULATIVE
          INCIDENCE FUNCTION (CIF) (PROPOSED BY \citeonline{SCHEIKE}),
          IN A MODEL WITH TWO COMPETING CAUSES OF FAILURE, WITHOUT
          COVARIATES, AND WITH THE FOLLOWING CONFIGURATION: \(\beta_{2}
          = 0\), \(\bm{u} = 0\) AND \(\bm{\eta} = 0\); IN EACH SCENARIO
          ALL OTHER COEFFICIENTS ARE SET TO ZERO, WITH THE EXCEPTION
          OF \(w_{1} = 1\)}
 \label{fig:cifcoefs}
\end{figure}

\begin{figure}[H]
 \centering
 \includegraphics[width=0.9\textwidth]{pics/cif-1.png}
 \caption{ILLUSTRATION OF A GIVEN CLUSTER-SPECIFIC CUMULATIVE INCIDENCE
          FUNCTION (CIF), PROPOSED BY \citeonline{SCHEIKE}, IN A MODEL
          WITH TWO COMPETING CAUSES OF FAILURE, WITHOUT COVARIATES AND
          THE FOLLOWING CONFIGURATION: \(\beta_{1} = -2\),
          \(\beta_{2} = -1\), \(\gamma_{1} = 1\), \(w_{1} = 3\) AND
          \(u_{2} = 0\). THE VARIATION BETWEEN FRAMES IS GIVEN BY THE
          LATENT EFFECTS \(u_{1}\) AND \(\eta_{1}\)}
 \label{fig:cif}
\end{figure}

\section{Estimation and inference}
\label{inference}

\section{Simulation studies}
\label{simulation}

\section{Discussion}
\label{discussion}

\section*{Supplementary material}

\bibliographystyle{dcu}
\bibliography{references}

\end{document}
