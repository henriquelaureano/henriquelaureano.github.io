<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Poisson distribution | _main.utf8.md</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Poisson distribution | _main.utf8.md" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Poisson distribution | _main.utf8.md" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="uniform-distribution.html">
<link rel="next" href="hypergeometric-distribution.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script><script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script><script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script><script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
                    <style type="text/css">
                    .code-folding-btn { margin-bottom: 4px; }
                    .row { display: flex; }
                    .collapse { display: none; }
                    .in { display:block }
                    .pull-right > .dropdown-menu { right: 0; left: auto; }
                    .open > .dropdown-menu { display: block; }
                    .dropdown-menu { position: absolute;
                                     top: 100%;
                                     left: 0;
                                     z-index: 1000;
                                     display: none;
                                     float: left;
                                     min-width: 160px;
                                     padding: 5px 0;
                                     margin: 2px 0 0;
                                     font-size: 14px;
                                     text-align: left;
                                     list-style: none;
                                     background-color: #fff;
                                     -webkit-background-clip: padding-box;
                                     background-clip: padding-box;
                                     border: 1px solid #ccc;
                                     border: 1px solid rgba(0,0,0,.15);
                                     border-radius: 4px;
                                     -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
                                     box-shadow: 0 6px 12px rgba(0,0,0,.175);
                                   }
                    </style><script>
                    $(document).ready(function () {
                     window.initializeCodeFolding("show" === "show");
                    });
                    </script>
<script>
                    document.write('<div class="btn-group pull-right"
                                          style="position: absolute;
                                                 top: 20%;
                                                 right: 2%;
                                                 z-index: 200">
                                     <button type="button"
                                             class="btn btn-default btn-xs dropdown-toggle"
                                             data-toggle="dropdown"
                                             aria-haspopup="true"
                                             aria-expanded="true"
                                             data-_extension-text-contrast="">
                                     <span>Code</span>
                                     <span class="caret"></span>
                                     </button><ul class="dropdown-menu"
                                                  style="min-width: 50px;">
                                     <li><a id="rmd-show-all-code" href="#">
                                         Show All Code</a></li>
                                     <li><a id="rmd-hide-all-code" href="#">
                                         Hide All Code</a></li>
                                              </ul></div>')
                    </script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>README</a></li>
<li class="chapter" data-level="" data-path="uniform-distribution.html"><a href="uniform-distribution.html"><i class="fa fa-check"></i>Uniform distribution</a></li>
<li class="chapter" data-level="" data-path="poisson-distribution.html"><a href="poisson-distribution.html"><i class="fa fa-check"></i>Poisson distribution</a><ul>
<li class="chapter" data-level="" data-path="poisson-distribution.html"><a href="poisson-distribution.html#lkl-quad.-approx.-and-intervals"><i class="fa fa-check"></i>Lkl, quad. approx. and intervals</a></li>
<li class="chapter" data-level="" data-path="poisson-distribution.html"><a href="poisson-distribution.html#another-parametrization"><i class="fa fa-check"></i>Another parametrization</a></li>
<li class="chapter" data-level="" data-path="poisson-distribution.html"><a href="poisson-distribution.html#more-intervals"><i class="fa fa-check"></i>More intervals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hypergeometric-distribution.html"><a href="hypergeometric-distribution.html"><i class="fa fa-check"></i>Hypergeometric distribution</a><ul>
<li class="chapter" data-level="" data-path="hypergeometric-distribution.html"><a href="hypergeometric-distribution.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="hypergeometric-distribution.html"><a href="hypergeometric-distribution.html#mle-and-intervals"><i class="fa fa-check"></i>MLE and intervals</a></li>
<li class="chapter" data-level="" data-path="hypergeometric-distribution.html"><a href="hypergeometric-distribution.html#again-but-different"><i class="fa fa-check"></i>Again but different</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-distribution-with-interval-data.html"><a href="gaussian-distribution-with-interval-data.html"><i class="fa fa-check"></i>Gaussian distribution with interval data</a><ul>
<li class="chapter" data-level="" data-path="gaussian-distribution-with-interval-data.html"><a href="gaussian-distribution-with-interval-data.html#likelihood-1"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="gaussian-distribution-with-interval-data.html"><a href="gaussian-distribution-with-interval-data.html#mle"><i class="fa fa-check"></i>MLE</a></li>
<li class="chapter" data-level="" data-path="gaussian-distribution-with-interval-data.html"><a href="gaussian-distribution-with-interval-data.html#profile-likelihood"><i class="fa fa-check"></i>Profile likelihood</a></li>
<li class="chapter" data-level="" data-path="gaussian-distribution-with-interval-data.html"><a href="gaussian-distribution-with-interval-data.html#standard-error"><i class="fa fa-check"></i>Standard error</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-regression.html"><a href="gaussian-regression.html"><i class="fa fa-check"></i>Gaussian regression</a><ul>
<li class="chapter" data-level="" data-path="gaussian-regression.html"><a href="gaussian-regression.html#likelihood-2"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="gaussian-regression.html"><a href="gaussian-regression.html#mle-1"><i class="fa fa-check"></i>MLE</a></li>
<li class="chapter" data-level="" data-path="gaussian-regression.html"><a href="gaussian-regression.html#joint-likelihood"><i class="fa fa-check"></i>Joint likelihood</a><ul>
<li><a href="gaussian-regression.html#with-sigma-fixed-in-its-mle">With <span class="math inline">\(\sigma\)</span> fixed in its MLE</a></li>
<li><a href="gaussian-regression.html#profile-likelihood-wrt-sigma">Profile likelihood wrt <span class="math inline">\(\sigma\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-regression.html"><a href="gaussian-regression.html#profile-likelihood-1"><i class="fa fa-check"></i>Profile likelihood</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i>Poisson regression</a><ul>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html#likelihood-3"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html#profile-likelihood-2"><i class="fa fa-check"></i>Profile likelihood</a></li>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html#mle-2"><i class="fa fa-check"></i>MLE</a></li>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html#intervals"><i class="fa fa-check"></i>Intervals</a></li>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html#did-we-obtained-the-right-values"><i class="fa fa-check"></i>Did we obtained the right values?</a></li>
</ul></li>
<li><a href="poisson-regression-extra.html#poisson-regression-extra">Poisson regression (<em>extra</em>)</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="poisson-distribution" class="section level1 unnumbered">
<h1>Poisson distribution</h1>
<hr />
<p><strong>Let <span class="math inline">\(X\)</span> be a r.v. of a Poisson distribution (<span class="math inline">\(X \sim P(\lambda)\)</span>) for
which the following random sample was obtained: (3, 1, 0, 2, 1, 1, 0, 0).</strong></p>
<hr />
<pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</code></pre>
<div id="lkl-quad.-approx.-and-intervals" class="section level2 unnumbered">
<h2>Lkl, quad. approx. and intervals</h2>
<hr />
<p><strong>Obtain the likelihood function, its quadratic approximation and intervals for
<span class="math inline">\(\lambda\)</span>.</strong></p>
<hr />
<p>The likelihood and the log-likelihood of a Poisson(<span class="math inline">\(\lambda\)</span>) is</p>
<p><span class="math display">\[
 L(\lambda) = \prod_{i=1}^{n} \frac{e^{-\lambda} \lambda^{x_{i}}}{x_{i}!}
              \quad \text{and} \quad
 \log L(\lambda) = l(\lambda) =
 -n \lambda + \log \lambda \sum_{i=1}^{n} x_{i} - \sum_{i=1}^{n} \log x_{i}!.
\]</span></p>
<p><em>We work here with the log-likelihood to make our life easier, since the
computations are much simpler in the log scale.</em></p>
<p>By computing the Score (derivative of <span class="math inline">\(l(\lambda)\)</span> wrt to <span class="math inline">\(\lambda\)</span>) and
making it equal to zero, we find the MLE <span class="math inline">\(\hat{\lambda} = \bar{x}\)</span>. Computing
the second derivative we find the observed information</p>
<p><span class="math display">\[
 I_{O}(\lambda) = \frac{n \bar{x}}{\lambda^{2}}  \quad \rightarrow \quad
 I_{O}(\hat{\lambda}) = \frac{n}{\bar{x}}.
\]</span></p>
<p>A graph of the Poisson log-likelihood is provided in black in
Figure <a href="poisson-distribution.html#fig:poisson">2</a>.</p>
<p>Doing a quadratic approximation (Taylor expansion of second order) in
<span class="math inline">\(l(\lambda)\)</span> around <span class="math inline">\(\hat{\lambda}\)</span> we have</p>
<p><span class="math display">\[
\begin{align*}
 l(\lambda) &amp;\approx l(\hat{\lambda})
            + (\lambda - \hat{\lambda}) {l}&#39;(\hat{\lambda})
            + \frac{1}{2} (\lambda - \hat{\lambda})^{2} {l}&#39;&#39;(\hat{\lambda})\\
            &amp;\quad(\text{the Score is zero at the MLE})\\
            &amp;= l(\hat{\lambda})
            + \frac{1}{2} (\lambda - \hat{\lambda})^{2} {l}&#39;&#39;(\hat{\lambda})
            = l(\hat{\lambda})
            + \frac{1}{2} (\lambda - \hat{\lambda})^{2} I_{O}(\hat{\lambda}).
\end{align*}
\]</span></p>
<p>A graph of the quadratic approximation of the Poisson log-likelihood is provided
in gray in Figure <a href="poisson-distribution.html#fig:poisson">2</a>. There we can see how good is the
approximation around the maximum likelihood estimator (MLE). Here the sample size
is very small, the idea is that as the sample size increase the quality, in this
case the range, of the approximation also increase. This should happen because as
the sample size increase the Poisson likelihood should be more symmetric.</p>
<p>In the topright graph of Figure <a href="poisson-distribution.html#fig:poisson">2</a> we have two intervals for
<span class="math inline">\(\lambda\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># likelihood ---------------------------------------------------------------------</span>
lkl.poi &lt;-<span class="st"> </span><span class="cf">function</span>(lambda, data) {
    n &lt;-<span class="st"> </span><span class="kw">length</span>(data)
    <span class="co"># log-likelihood ignoring irrelevant constant terms</span>
    lkl =<span class="st"> </span><span class="op">-</span>n <span class="op">*</span><span class="st"> </span>lambda <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(data) <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(lambda)
    <span class="kw">return</span>(lkl)
}
lambda.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">4.5</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)
lklseq.poi &lt;-<span class="st"> </span><span class="kw">lkl.poi</span>(lambda.seq, data)

<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">.1</span>)
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="dv">1</span>)) <span class="co"># plot window definition</span>
<span class="kw">plot</span>(lambda.seq, lklseq.poi, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
     <span class="dt">xlab =</span> <span class="kw">expression</span>(lambda), <span class="dt">ylab =</span> <span class="st">&quot;log-likelihood&quot;</span>)
lambda.est &lt;-<span class="st"> </span><span class="kw">mean</span>(data) <span class="co"># MLE</span>
<span class="kw">abline</span>(<span class="dt">v =</span> lambda.est, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="co"># quadratic approximation --------------------------------------------------------</span>
quadprox.poi &lt;-<span class="st"> </span><span class="cf">function</span>(lambda, lambda.est, data) {
    n &lt;-<span class="st"> </span><span class="kw">length</span>(data)
    obs.info &lt;-<span class="st"> </span>n <span class="op">/</span><span class="st"> </span>lambda.est <span class="co"># observed information</span>
    <span class="kw">lkl.poi</span>(lambda.est, data) <span class="op">-</span><span class="st"> </span><span class="fl">.5</span> <span class="op">*</span><span class="st"> </span>obs.info <span class="op">*</span><span class="st"> </span>(lambda <span class="op">-</span><span class="st"> </span>lambda.est)<span class="op">**</span><span class="dv">2</span>
}
<span class="kw">curve</span>(<span class="kw">quadprox.poi</span>(x, lambda.est, data), <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw">legend</span>(<span class="fl">2.4</span>, <span class="fl">-6.25</span>, <span class="kw">c</span>(<span class="st">&quot;log-like&quot;</span>, <span class="st">&quot;Quadratic</span><span class="ch">\n</span><span class="st">approx.&quot;</span>, <span class="st">&quot;MLE&quot;</span>),
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="st">&quot;darkgray&quot;</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)
<span class="co"># intervals for lambda -----------------------------------------------------------</span>
<span class="kw">plot</span>(lambda.seq, lklseq.poi, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
     <span class="dt">xlab =</span> <span class="kw">expression</span>(lambda), <span class="dt">ylab =</span> <span class="st">&quot;log-likelihood&quot;</span>)
<span class="kw">curve</span>(<span class="kw">quadprox.poi</span>(x, lambda.est, data), <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> lambda.est, <span class="dt">lty =</span> <span class="dv">3</span>)
## probability-based interval ----------------------------------------------------
<span class="co"># cutoff&#39;s corresponding to a 95\% confidence interval for the mean</span>
cut &lt;-<span class="st"> </span><span class="kw">log</span>(.<span class="dv">15</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lkl.poi</span>(lambda.est, data) ; <span class="kw">abline</span>(<span class="dt">h =</span> cut, <span class="dt">lty =</span> <span class="dv">2</span>)
ic.lkl.poi &lt;-<span class="st"> </span><span class="cf">function</span>(lambda, cut, ...) { <span class="kw">lkl.poi</span>(lambda, ...) <span class="op">-</span><span class="st"> </span>cut }
ic.<span class="fl">95.</span>prob &lt;-<span class="st"> </span>rootSolve<span class="op">::</span><span class="kw">uniroot.all</span>(ic.lkl.poi, <span class="kw">range</span>(lambda.seq),
                                     <span class="dt">data =</span> data, <span class="dt">cut =</span> cut)
<span class="kw">arrows</span>(<span class="dt">x0 =</span> ic.<span class="fl">95.</span>prob, <span class="dt">y0 =</span> <span class="kw">rep</span>(cut, <span class="dv">2</span>),
       <span class="dt">x1 =</span> ic.<span class="fl">95.</span>prob, <span class="dt">y1 =</span> <span class="kw">rep</span>(<span class="op">-</span><span class="dv">25</span>, <span class="dv">2</span>), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">length =</span> <span class="fl">.1</span>)
## wald confidence interval  -----------------------------------------------------
cut &lt;-<span class="st"> </span><span class="kw">log</span>(.<span class="dv">15</span>) <span class="op">+</span><span class="st"> </span><span class="kw">quadprox.poi</span>(lambda.est, lambda.est, data)
<span class="kw">abline</span>(<span class="dt">h =</span> cut, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>)
se.lambda.est &lt;-<span class="st"> </span><span class="kw">sqrt</span>(lambda.est <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(data))
wald<span class="fl">.95</span> &lt;-<span class="st"> </span>lambda.est <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>)) <span class="op">*</span><span class="st"> </span>se.lambda.est
<span class="kw">arrows</span>(<span class="dt">x0 =</span> wald<span class="fl">.95</span>, <span class="dt">y0 =</span> <span class="kw">rep</span>(cut, <span class="dv">2</span>),
       <span class="dt">x1 =</span> wald<span class="fl">.95</span>, <span class="dt">y1 =</span> <span class="kw">rep</span>(<span class="op">-</span><span class="dv">25</span>, <span class="dv">2</span>), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">length =</span> <span class="fl">.1</span>, <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>)
<span class="co"># a better look in the approximation around the MLE ------------------------------</span>
lambda.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">8</span>, <span class="fl">1.2</span>, <span class="dt">length.out =</span> <span class="dv">25</span>)
<span class="kw">plot</span>(lambda.seq, <span class="kw">lkl.poi</span>(lambda.seq, data), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
     <span class="dt">xlab =</span> <span class="kw">expression</span>(lambda), <span class="dt">ylab =</span> <span class="st">&quot;log-likelihood&quot;</span>)
<span class="kw">curve</span>(<span class="kw">quadprox.poi</span>(x, lambda.est, data), <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> lambda.est, <span class="dt">lty =</span> <span class="dv">3</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:poisson"></span>
<img src="_main_files/figure-html/poisson-1.png" alt="log-likelihood function and MLE of \(\lambda\) in Poisson(\(\lambda\)) based on \texttt{data}. In the topleft, a quadratic approximation in gray. In the topright, two intervals for \(\lambda\) - one based in the likelihood (in black) and one based in the quadratic approximation (in gray). In the bottom we provide a better look in the quadratic approximation." width="672" />
<p class="caption">
Figure 2: log-likelihood function and MLE of <span class="math inline">\(\lambda\)</span> in Poisson(<span class="math inline">\(\lambda\)</span>) based on . In the topleft, a quadratic approximation in gray. In the topright, two intervals for <span class="math inline">\(\lambda\)</span> - one based in the likelihood (in black) and one based in the quadratic approximation (in gray). In the bottom we provide a better look in the quadratic approximation.
</p>
</div>
<p>In the topright, in black, we have a interval based in the likelihood,
<span class="math inline">\(\lambda \in (0.459, 1.855)\)</span>, but with
a cutoff criterion based in a <span class="math inline">\(\chi^{2}\)</span> distribution. Thus, to have a nominal
95% confidence interval we use a cutoff <span class="math inline">\(c = 15\%\)</span>. As we saw before, this
interval is based in a large-sample theory. Since we’re dealing here with a
reasonable regular case, this interval shows as a good approximation.</p>
<p>Still in the topright of Figure <a href="poisson-distribution.html#fig:poisson">2</a>, in red we have a interval
based in the quadratic approximation of the log-likelihood,
<span class="math inline">\(\lambda \in (0.307, 1.693)\)</span>. From the
quadratic approximation we get</p>
<p><span class="math display">\[
 \log \frac{L(\lambda)}{L(\hat{\lambda})} \approx
 -\frac{1}{2} I_{O}(\hat{\lambda}) (\lambda - \hat{\lambda})^{2},
\]</span></p>
<p>that also follows a <span class="math inline">\(\chi^{2}\)</span> distribution, since we have a r.v.
<span class="math inline">\(\hat{\lambda}\)</span> normalized (with its expected value subtracted and divided by
its variance) and squared. From this we get the following exact (in the normal
case) 95% confidence interval</p>
<p><span class="math display">\[
 \hat{\lambda} \pm 1.96~I_{O}(\hat{\lambda})^{-1/2}
 \qquad (\hat{\lambda} \pm 1.96~\text{se}(\hat{\lambda})).
\]</span></p>
<p>In the nonnormal cases this is an approximate 95% CI.</p>
<p><em>The actual variance is <span class="math inline">\(I_{E}(\hat{\lambda})^{-1/2}\)</span>, but for the Poisson
case the Fisher (expected) information is equal to the observed one,
<span class="math inline">\(I_{O}(\hat{\lambda})^{-1/2}\)</span></em>.</p>
<p>A very nice thing that we can see from this intervals is that a Wald interval
(a <span class="math inline">\(\pm\)</span> interval) corresponds to a cut in the quadratic approximation exactly
in the same point that the probability-based interval cuts the (log-)likelihood.
Thus, as more regular the likelihood, better will be the fit of the
approximation and more reliable will be the Wald interval.</p>
</div>
<div id="another-parametrization" class="section level2 unnumbered">
<h2>Another parametrization</h2>
<hr />
<p><strong>Repeat the previous question for reparametrization <span class="math inline">\(\theta = \log (\lambda)\)</span>.</strong></p>
<hr />
<p>By the invariance property of the MLE we have</p>
<p><span class="math display">\[
 \hat{\lambda} = \bar{x} \quad \Rightarrow \quad
 g(\hat{\lambda}) = \log \hat{\lambda} = \hat{\theta}
                  = \log \bar{x} = g(\bar{x}).
\]</span>
i.e., the MLE of <span class="math inline">\(\hat{\theta}\)</span> is <span class="math inline">\(\log \bar{x}\)</span>.</p>
<p>By the Delta Method we compute the variance of <span class="math inline">\(\hat{\theta}\)</span>,</p>
<p><span class="math display">\[
 V[\theta] = V[g(\lambda)]
           = \left[\frac{\partial}{\partial \lambda} g(\lambda)
             \right]^{2} V[\lambda]
           = \left[\frac{1}{\lambda}\right]^{2} \frac{\lambda}{n}
           = \frac{1}{\lambda~n} \quad \rightarrow \quad
 V[\hat{\theta}] = \frac{1}{\bar{x}~n}.
\]</span>
From this we can take the observed information for the reparametrization</p>
<p><span class="math display">\[ V[\hat{\theta}] = I_{O}^{-1}(\hat{\theta}) = (\bar{x}~n)^{-1}. \]</span></p>
<p><em>Now we do, in the same manner, everything that we did in the previous letter.</em></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># likelihood ---------------------------------------------------------------------</span>
## we can still use the lkl.poi function, but now we do
## lambda = exp(theta),
## with theta being a real rate (positive or negative)
theta.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)
lklseq.poi &lt;-<span class="st"> </span><span class="kw">lkl.poi</span>(<span class="kw">exp</span>(theta.seq), data)

<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">.1</span>)
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="dv">1</span>)) <span class="co"># plot window definition</span>
<span class="kw">plot</span>(theta.seq, lklseq.poi, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
     <span class="dt">xlab =</span> <span class="kw">expression</span>(theta), <span class="dt">ylab =</span> <span class="st">&quot;log-likelihood&quot;</span>)
theta.est &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="kw">mean</span>(data)) <span class="co"># MLE</span>
<span class="kw">abline</span>(<span class="dt">v =</span> theta.est, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="co"># quadratic approximation for the reparametrization ------------------------------</span>
quadprox.poi.repa &lt;-<span class="st"> </span><span class="cf">function</span>(theta, theta.est, data) {
    obs.info &lt;-<span class="st"> </span><span class="kw">sum</span>(data) <span class="co"># observed information</span>
    <span class="kw">lkl.poi</span>(<span class="kw">exp</span>(theta.est), data) <span class="op">-</span><span class="st"> </span><span class="fl">.5</span> <span class="op">*</span><span class="st"> </span>obs.info <span class="op">*</span><span class="st"> </span>(theta <span class="op">-</span><span class="st"> </span>theta.est)<span class="op">**</span><span class="dv">2</span>
}
<span class="kw">curve</span>(<span class="kw">quadprox.poi.repa</span>(x, theta.est, data), <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)

<span class="kw">legend</span>(<span class="op">-</span><span class="fl">2.15</span>, <span class="fl">-27.5</span>, <span class="kw">c</span>(<span class="st">&quot;log-like&quot;</span>, <span class="st">&quot;Quadratic</span><span class="ch">\n</span><span class="st">approx.&quot;</span>, <span class="st">&quot;MLE&quot;</span>),
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="st">&quot;darkgray&quot;</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)
<span class="co"># intervals for lambda -----------------------------------------------------------</span>
<span class="kw">plot</span>(theta.seq, lklseq.poi, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
     <span class="dt">xlab =</span> <span class="kw">expression</span>(theta), <span class="dt">ylab =</span> <span class="st">&quot;log-likelihood&quot;</span>)
<span class="kw">curve</span>(<span class="kw">quadprox.poi.repa</span>(x, theta.est, data), <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> theta.est, <span class="dt">lty =</span> <span class="dv">3</span>)
## probability-based interval ----------------------------------------------------
<span class="co"># cutoff&#39;s corresponding to a 95\% confidence interval for the mean</span>
cut &lt;-<span class="st"> </span><span class="kw">log</span>(.<span class="dv">15</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lkl.poi</span>(<span class="kw">exp</span>(theta.est), data) ; <span class="kw">abline</span>(<span class="dt">h =</span> cut, <span class="dt">lty =</span> <span class="dv">2</span>)
ic.lkl.poi &lt;-<span class="st"> </span><span class="cf">function</span>(theta, cut, ...) {
    lambda &lt;-<span class="st"> </span><span class="kw">exp</span>(theta)
    <span class="kw">lkl.poi</span>(lambda, ...) <span class="op">-</span><span class="st"> </span>cut
}
ic.<span class="fl">95.</span>prob &lt;-<span class="st"> </span>rootSolve<span class="op">::</span><span class="kw">uniroot.all</span>(ic.lkl.poi, <span class="kw">range</span>(theta.seq),
                                     <span class="dt">data =</span> data, <span class="dt">cut =</span> cut)
<span class="kw">arrows</span>(<span class="dt">x0 =</span> ic.<span class="fl">95.</span>prob, <span class="dt">y0 =</span> <span class="kw">rep</span>(cut, <span class="dv">2</span>),
       <span class="dt">x1 =</span> ic.<span class="fl">95.</span>prob, <span class="dt">y1 =</span> <span class="kw">rep</span>(<span class="op">-</span><span class="dv">43</span>, <span class="dv">2</span>), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">length =</span> <span class="fl">.1</span>)
## wald confidence interval  -----------------------------------------------------
cut &lt;-<span class="st"> </span><span class="kw">log</span>(.<span class="dv">15</span>) <span class="op">+</span><span class="st"> </span><span class="kw">quadprox.poi.repa</span>(theta.est, theta.est, data)
<span class="kw">abline</span>(<span class="dt">h =</span> cut, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>)

se.theta.est &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(data))
wald<span class="fl">.95</span> &lt;-<span class="st"> </span>theta.est <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>)) <span class="op">*</span><span class="st"> </span>se.theta.est

<span class="kw">arrows</span>(<span class="dt">x0 =</span> wald<span class="fl">.95</span>, <span class="dt">y0 =</span> <span class="kw">rep</span>(cut, <span class="dv">2</span>),
       <span class="dt">x1 =</span> wald<span class="fl">.95</span>, <span class="dt">y1 =</span> <span class="kw">rep</span>(<span class="op">-</span><span class="dv">43</span>, <span class="dv">2</span>), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">length =</span> <span class="fl">.1</span>, <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>)
<span class="co"># a better look in the approximation around the MLE ------------------------------</span>
theta.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span>.<span class="dv">75</span>, <span class="fl">.75</span>, <span class="dt">length.out =</span> <span class="dv">25</span>)
<span class="kw">plot</span>(theta.seq, <span class="kw">lkl.poi</span>(<span class="kw">exp</span>(theta.seq), data), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
     <span class="dt">xlab =</span> <span class="kw">expression</span>(theta), <span class="dt">ylab =</span> <span class="st">&quot;log-likelihood&quot;</span>)
<span class="kw">curve</span>(<span class="kw">quadprox.poi.repa</span>(x, theta.est, data), <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> theta.est, <span class="dt">lty =</span> <span class="dv">3</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:poisson-reparametrization"></span>
<img src="_main_files/figure-html/poisson-reparametrization-1.png" alt="log-likelihood function and MLE of \(\theta\) in Poisson(\(\lambda = e^{\theta}\)) based on \texttt{data}. In the topleft, a quadratic approximation in gray. In the topright, two intervals for \(\theta\) - one based in the likelihood (in black) and one based in the quadratic approximation (in gray). In the bottom we provide a better look in the quadratic approximation." width="672" />
<p class="caption">
Figure 3: log-likelihood function and MLE of <span class="math inline">\(\theta\)</span> in Poisson(<span class="math inline">\(\lambda = e^{\theta}\)</span>) based on . In the topleft, a quadratic approximation in gray. In the topright, two intervals for <span class="math inline">\(\theta\)</span> - one based in the likelihood (in black) and one based in the quadratic approximation (in gray). In the bottom we provide a better look in the quadratic approximation.
</p>
</div>
<p>We obtained here two intervals for <span class="math inline">\(\theta\)</span>. One based in a cut in the
likelihood,
<span class="math inline">\(\theta \in (-0.778, 0.618)\)</span> - in black on
the topright of Figure <a href="poisson-distribution.html#fig:poisson-reparametrization">3</a>, and one based in a
cut in the quadratic approximation of the likelihood,
<span class="math inline">\(\theta \in (-0.693, 0.693)\)</span> - in gray on the
topright of Figure <a href="poisson-distribution.html#fig:poisson-reparametrization">3</a>.</p>
<p>With the parametrization <span class="math inline">\(\theta = \log \lambda\)</span> the two intervals are closer
than the ones obtained for <span class="math inline">\(\lambda\)</span>. i.e., for <span class="math inline">\(\theta\)</span> (with the use of the
<span class="math inline">\(\log\)</span>) we get a more regular likelihood.</p>
</div>
<div id="more-intervals" class="section level2 unnumbered">
<h2>More intervals</h2>
<hr />
<p><strong>Also obtain (by at least two different methods) confidence intervals for the
parameter <span class="math inline">\(\lambda\)</span> from the likelihood function (approximate or not) of
<span class="math inline">\(\theta\)</span>.</strong></p>
<hr />
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># likelihood ---------------------------------------------------------------------</span>
theta.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)
lklseq.poi &lt;-<span class="st"> </span><span class="kw">lkl.poi</span>(<span class="kw">exp</span>(theta.seq), data)

<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">.1</span>)
<span class="kw">plot</span>(theta.seq, lklseq.poi, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
     <span class="dt">xlab =</span> <span class="kw">expression</span>(theta), <span class="dt">ylab =</span> <span class="st">&quot;log-likelihood&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> lambda.est, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="co"># quadratic approximation for the reparametrization ------------------------------</span>
<span class="kw">curve</span>(<span class="kw">quadprox.poi.repa</span>(x, theta.est, data), <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw">legend</span>(<span class="op">-</span><span class="fl">2.15</span>, <span class="dv">-25</span>, <span class="kw">c</span>(<span class="st">&quot;log-like&quot;</span>, <span class="st">&quot;Quadratic</span><span class="ch">\n</span><span class="st">approx.&quot;</span>, <span class="st">&quot;MLE&quot;</span>),
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="st">&quot;darkgray&quot;</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)
<span class="co"># intervals for lambda -----------------------------------------------------------</span>
## probability-based interval ----------------------------------------------------
<span class="kw">arrows</span>(<span class="dt">x0 =</span> <span class="kw">exp</span>(ic.<span class="fl">95.</span>prob), <span class="dt">y0 =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">9</span>, <span class="fl">-36.5</span>),
       <span class="dt">x1 =</span> <span class="kw">exp</span>(ic.<span class="fl">95.</span>prob), <span class="dt">y1 =</span> <span class="kw">rep</span>(<span class="op">-</span><span class="dv">43</span>, <span class="dv">2</span>), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">length =</span> <span class="fl">.1</span>)
## wald confidence interval  -----------------------------------------------------
<span class="kw">arrows</span>(<span class="dt">x0 =</span> <span class="kw">exp</span>(wald<span class="fl">.95</span>), <span class="dt">y0 =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">9</span>, <span class="dv">-24</span>),
       <span class="dt">x1 =</span> <span class="kw">exp</span>(wald<span class="fl">.95</span>), <span class="dt">y1 =</span> <span class="kw">rep</span>(<span class="op">-</span><span class="dv">43</span>, <span class="dv">2</span>), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">length =</span> <span class="fl">.1</span>, <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:poisson-c"></span>
<img src="_main_files/figure-html/poisson-c-1.png" alt="log-likelihood function and quadratic approximation of \(\theta\), and MLE of \(\lambda\) in Poisson(\(\lambda = e^{\theta}\)) based on \texttt{data}. In dashed, 95\% confidence intervals for \(\lambda\)." width="360" />
<p class="caption">
Figure 4: log-likelihood function and quadratic approximation of <span class="math inline">\(\theta\)</span>, and MLE of <span class="math inline">\(\lambda\)</span> in Poisson(<span class="math inline">\(\lambda = e^{\theta}\)</span>) based on . In dashed, 95% confidence intervals for <span class="math inline">\(\lambda\)</span>.
</p>
</div>
<p>Since the MLE has the invariance property, a very simple idea is: take the
obtained interval for <span class="math inline">\(\theta\)</span> and apply a transformation,
<span class="math inline">\(\lambda = e^{\theta}\)</span>. This simple idea is true for the interval obtained via
likelihood function, as we can see in Figure <a href="poisson-distribution.html#fig:poisson-c">4</a>. The obtained
interval is the same that the one in letter <span class="math inline">\(\texttt{a)}\)</span>. However, this idea
doesn’t work for the interval based in the quadratic approximation.</p>
<p>In the letter <span class="math inline">\(\texttt{a)}\)</span>, via the quadratic approximation we got
<span class="math inline">\(\lambda \in (0.307, 1.693)\)</span>. Here, applying the relation
<span class="math inline">\(\lambda = e^{\theta}\)</span> we get
<span class="math inline">\(\lambda \in (0.5, 2)\)</span>. i.e.,
this shows that the invariance property applies to the likelihood, not to the
quadratic approximation of the likelihood.</p>
<hr />
<p><img src="logos.png" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="uniform-distribution.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hypergeometric-distribution.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
