Consider a cluster of random variables representing the time until the
occurrence of some event. The random variables that compose that cluster
are assumed to be correlated, i.e. for some biological or environmental
reason it is not adequate to assume independence between them. Also, we
may be interested in the occurrence of not only one specific event,
having in practice a competition of events to see which one happens
first, if it happens. Such events may also be of low probability but
with severe consequences, that is the moment when the correlation
ingredient makes its difference: the occurrence of an event in a subject
should affect the probability of the same happening in the others.

A realistic context that fits perfectly with the framework described
above is the study of disease incidence in family members, where each
member is indexed by a random variable and each cluster consists of a
family. The inspiration to the study of these kinds of problems came
from the work developed in \citeonline{SCHEIKE}, where they studied
breast cancer incidence in mothers and daughters. Based on that, the aim
of this thesis is to propose a simpler framework to make inference on
the gender-specific cancer incidence in twins. The twins' case is just
one more in the range of possible applications to our model, but given
its intrinsic particularities, becomes the focus application. Until now
we just contextualized, we still need to introduce the methodology. To
this, some definitions and theoretical contexts are welcome.

When the object under study is random variables representing the time
until some event occurs, we're in the field of \textit{failure time
  data}~\cite{kalb&prentice}. The occurrence of an event is generally
called as a \textit{failure}, and major areas of application are
biomedical studies and industrial life testing. In this thesis, we
maintain our focus on the former.

As is common in science, same methodologies can receive different names
in different areas. In industrial life testing applications is performed
what is called a \textit{reliability analysis}; in biomedical studies is
performed what is called \textit{survival analysis}. Generally, the term
survival analysis is applied when we're interested in the occurrence of
only one event, a \textit{failure time process}. When we're interested
in the occurrence of more than one event, like now, we enter in the yard
of \textit{competing risks} and \textit{multistate} models. A visual aid
is presented on \autoref{fig:intro1} and a comprehensive reference
is~\citeonline{kalb&prentice}.

Failure time and competing risk processes may be seen as particular
cases of a multistate model. Besides the number of events (states) of
interest, the main difference between a multistate model and its
particular cases is that only in the multistate scenario we may have
transient states, using a \textit{stochastic process} language. In the
particular cases, all the states besides the initial state 0, are
absorbents - once you reached it you don't leave. The simplest
multistate model that exemplify this behavior is the so-called
illness-death model, \autoref{fig:intro1}~C), i.e. a patient enters the
study (state 0) and it can get sick (state 1) or die (state 2); if sick
it can recover (returns to state 0) or die. We will work only with
competing risk processes. For each individual, we have the time (age)
until the occurrence, or not, of cancer.

\begin{figure}[H]
  \setlength{\abovecaptionskip}{.0001pt}
  \caption{BEHAVIOR ILLUSTRATIONS OF MULTISTATE MODELS FOR A) FAILURE
    TIME PROCESS; B) COMPETING RISKS; AND C) ILNESS-DEATH MODEL, THE
    SIMPLEST MULTISTATE MODEL}
  \vspace{0.425cm} \centering
  \tikzfig{fig1}\\
  \vspace{0.45cm}
  \begin{footnotesize}
    SOURCE: The author~(2020).
  \end{footnotesize}
  \label{fig:intro1}
\end{figure}

When for some know or unknown reason we are not able to see the
occurrence of an event, we have what is called \textit{censorship}.
Still in the illness-death model: during the period of follow up the
patient may not get sick or die, staying at state 0, this is called a
\textit{right-censorship}; The same for state 1. If a patient is in
state 1 at the end of the study, we're \textit{censored} to see him
reaching the state 2 or returning to state 0. This is the inherent idea
to censorship and must be present in the modeling framework, in this
manner, arriving in the so-called \textit{survival models}.

A survival model deals with survival experience. Usually, survival
experience is modeled in the \textit{hazard} (failure rate) scale and
for an individual \(i\) can be written as
\begin{equation}
  \lambda(t \mid \bm{x}_{i}) =
  \lambda_{0}(t) \times c(\bm{x}_{i} \bm{\beta})
  \quad \text{at time } t,
  \label{eq:intro1}
\end{equation}
i.e. a product of \(\lambda_{0}(\cdot)\), an arbitrary baseline hazard
function, and \(c\), a specific function form that will depend on the
chosen probability distribution for the failure time and on a covariates
(explanatory/independent variables) vector \(\bm{x}_{i} =
[x_{1}~\dots~x_{p}]\), where \(\bm{\beta}^{\top} =
[\beta_{1}~\dots~\beta_{p}]\) is a vector of regression parameters. This
structure is specified for a simple failure time process, as
in~\autoref{fig:intro1}~A). Nevertheless, its idea is easy to extend. We
basically have the \autoref{eq:intro1} model for each cause-specific (in
a competing risks process) or transition (in a multistate process). A
complete and extensive detailing can be, again, found
in~\citeonline{kalb&prentice}.

In this work we approach the case of clustered competing risks. Besides
the cause-specific structure, we have to deal with the fact that the
events are happening in related individuals (twins). This configures
what is called \textit{family studies}, i.e. we have a cluster (a
family/pair of twins) dependence that needs to be considered and
modeled. This, possible, dependence is something that we do not actually
measure, but know (or just suppose) that exists. In the statistical
modeling language this characteristic receives the name of
\textit{random} or \textit{latent} effect. A survival model with a
latent effect, association, or unobserved heterogeneity, is called a
\textit{frailty model}~\cite{frailty78, frailty79}. In its simplest
form, a frailty is an unobserved random proportionality factor that
modifies the hazard function of an individual, or of related
individuals. Frailty models are extensions of the \autoref{eq:intro1}
model.

In the competing risks setting, the hazard scale (focusing on the
cause-specific hazard) is not the only possible scale to work on. A more
attractive possibility is to work on the probability scale, focusing on
the cause-specific cumulative incidence. Both may complement each
other~\cite{andersen12}. However, in family studies there is often a
strong interest in: describing age at disease onset and account for
within-family dependence. The point to be made is that the distribution
of age at disease onset is directly described by the cause-specific
cumulative incidence. Therefore, the probability scale is the logical
choice.

To work with competing risks data, on the probability scale, and with a
latent effect structure that allows for within-cluster dependence of
both risk and timing, \citeonline{SCHEIKE} proposed a pairwise composite
likelihood approach based on a linear model with multinomial response
distribution and multivariate normal latent effects (in a frailty model
the common choice for the latent effects is the gamma distribution).
This approach sounds complicated and unnecessary, so we try to reach the
same goal but with a much simpler framework, a generalized linear mixed
model (GLMM). Instead of concentrating on failure time data and
consequently having a survival/frailty model based on the hazard scale,
or using a complicated composite approach, we just build the joint
likelihood function (a multinomial model with a link function based on
the cause-specific cumulative incidence function accouting for an
appropriate latent effects structure), marginalize (integrate out the
latent effects) and optimize it.

To better contextualize our GLMM approach, lets first just define it
starting by the start. For a random individual \(i\), in a standard
linear model we assume that the response variable, \(Y_{i}\),
conditioned on the (possible) covariates follows a normal (Gaussian)
distribution and, what we do is to model its mean, \(\mu_{i} \equiv
\mathbb{E}(Y_{i})\), via a linear combination. As much well explained in
\citeonline{GLM72}, with the support of a ``link function'',
\(g(\cdot)\), we are able to generalize this idea to non-Gaussian
distributions. This extended framework received the name of generalized
linear model (GLM) and is characterized by the following mean structure
\[
 g(\mu_{i}) = \bm{x}_{i}\bm{\beta},
\]
where \(\bm{x}_{i}\) is the \(i^\text{th}\) row of a model matrix
\(\bm{x}\), and \(\bm{\beta}\) is a vector of unknown parameters.
Also, in a GLM the \(Y_{i}\) are independent and
\[
  Y_{i} \sim \text{some exponential family distribution}.
\]
The \textit{exponential family} of distributions includes many
distributions that are useful for practical modelling, such as the
Poisson (for counting data), binomial (dichotomic data), gamma
(continuous but positive) and normal (continuous data) distributions. A
comprehensive reference for GLMs is \citeonline{GLM89}.

What makes a GLM into a GLMM is the addition of a latent
(\textit{m}ixed) effect, \(\mathbf{u}\). The mean structure becomes
\[
  g(\mu_{i}) = \bm{x}_{i}\bm{\beta} + \mathbf{z}_{i}\mathbf{u},
  \quad \mathbf{u} \sim \mathcal{N}(\mathbf{0},\bm{\Sigma})
\]
where the latent effect is assumed to follow a multivariate normal
distribution of zero mean and a given variance-covariance matrix.

\section{GOALS}

\subsection{General goals}

Propose a multinomial generalized linear mixed model (multiGLMM) to the
cause-specific cumulative incidence function (CIF) of clustered
competing risks data.

\subsection{Specific goals}

\begin{enumerate}
\item Simulate from the multiGLMM to the cause-specific CIF, i.e.
  generate synthetic data from the model.

\item Write the model in the Template Model Builder (TMB) software,
  developed by \citeonline{TMB} and possibly the most efficient way of
  doing so, taking advantage of its functionalities: computation of all
  necessary gradients and Hessians via Automatic Differentiation (AD)
  and integration of the joint likelihood latent effects,
  marginalization, via an efficient Laplace approximation
  implementation.

\item Study the model identifiability through the proposition of models
  with different complexity levels in terms of parametric space.

\item Apply the model to synthetic data and a real-based dataset.

\item Compare the results of our multiGLMM to the cause-specific CIF
  with the results obtained with the pairwise composite approach of
  \citeonline{SCHEIKE}, the probably state-of-art to the study of
  clustered competing risks data.
\end{enumerate}

\section{JUSTIFICATION}

In the biomedical statistical modeling literature, the examination of
disease occurrence in related individuals receives the name of family
studies. Key points of interest are the within-family dependence and
determining the role of different risk factors. The within-family
dependence may reflect both disease heritability and the impact of
shared environmental effects. The role of different risk factors arrives
in the class of multivariate models, which options are limited in the
statistical literature. Thus, the number of statistical models for
competing risks data that accommodate the within-cluster (family)
dependence is even more limited. Some modeling options are briefly
commented in \citeonline{SCHEIKE}, with his pairwise composite approach
being proposed as a new and better option to model the cause-specific
cumulative incidence function (CIF, that describes age at disease onset)
of clustered competing risks data on the probability scale. We propose
to model the cause-specific CIF and accommodate the within-family
dependence in the same fashion (via a latent structure that allows the
absolute risk and the failure time distribution to vary between
families) but with an easier framework, based on a multinomial
generalized linear mixed model (multiGLMM) approach.

\section{LIMITATION}

This work restraint to the proposition and application of a specific
multinomial model for the cause-specific cumulative incidence function
of competing risks data with a latent effect structure to accommodate
within-family dependence with regard to both risk and timing. Given the
elevated model complexity, hypothesis tests; residual analysis; and
good-of-fit measures are not contemplated.

\section{THESIS ORGANIZATION}

This thesis contains 6 chapters including this introduction.
\autoref{cap:methods} presents a systematic review of the main aspects
involved in the construction and optimzation of a generalized linear
mixed model (GLMM). Given the modeling framework overview,
\autoref{cap:model} presents our multinomial GLMM (multiGLMM) to model
the cause-specific cumulative incidence function (CIF) of clustered
competing risks data. In \autoref{cap:datasets} we describes how to
simulate some synthetic data from the proposed model, and presents a
real-based dataset as an application. In \autoref{cap:results} the
obtained results are presented, and in \autoref{cap:finalc} we discuss
the contributions of this thesis and present some suggestions for future
work.

% END ==================================================================