We are handling with a complex survival data structure, the clustered
competing risks setting. But we are using a general statistical modeling
framework, the generalized linear mixed models (GLMMs), that was not
made for this purpose.

To model competing risks data, one has to choose in which scale to work.
We can work on the hazard scale dealing with the cause-specific hazard
or on the probability scale dealing with the cause-specific cumulative
incidence function (CIF). With the correct link function, we can make an
appropriate GLMM to work on that probability scale.

Our focus in this thesis is to be able to deal with complex family
studies, where there is generally a strong interest in describing age at
disease onset in the scenarios of within-cluster dependence. The
distribution of age at disease onset is directly described by the
cause-specific CIF. To make a GLMM work for this type of data we need to
accommodate the cause-specific CIFs and the censorings. Assuming the
conditional distribution for our model response as multinomial already
deals with both left-truncation and right-censoring, avoiding the
specification of a censoring distribution. The cause-specific CIFs can
be modeled via the link function of our, then, multinomial GLMM
(multiGLMM). The multinomial distribution also guarantees that the CIFs
of all causes are modeled.

Our choice of a general framework tries to make the inference of this
complex model, easier. Besides, taking advantage of all the procedures
mentioned in the previous chapter.

\section{CLUSTER-SPECIFIC CUMULATIVE INCIDENCE FUNCTION
  (CIF)}
\label{cap:cif}

Consider that the observed follow-up time of an individual is given by
\(T = \min(T^{\ast},~C)\), where \(T^{\ast}\) denote the failure time
and \(C\) denote the censoring time. Given the possible covariates \(X\)
(that can be time-dependent), for a cause-specific of failure \(k\) the
CIF is defined as
\begin{align*}
  F_{k}(t \mid X) &= \mathbb{P}[T \leq t, K = k \mid X]\\
                  &= \int_{0}^{t} f_{k}(z \mid X)~\text{d}z\\
                  &= \int_{0}^{t} \lambda_{k}(z \mid X)~S(z \mid X)
                    ~\text{d}z, \quad t > 0, \quad k = 1, \dots, K.
\end{align*}
where \(f_{k}(t \mid X)\) is the (sub)density for the time to a type
\(k\) failure. This is the general definition of a CIF, and to define it
we need to define the functions that compose the subdensity.

The first is the cause-specific hazard function or process
\[
  \lambda_{k}(t \mid X) =
  \lim_{h \rightarrow 0}~h^{-1}
  \mathbb{P}[t \leq T < t + h, K = k \mid T \geq t, X],
  \quad t > 0, \quad k = 1, \dots, K.
\]

In words, the cause-specific hazard function, \(\lambda_{k}(t \mid X)\),
represents the instantaneous rate for failures of type \(k\) at time
\(t\) given \(X\) and all other failure types (competing causes). If
we sum up all cause-specific hazard function we get the overall hazard
function,
\[
  \lambda(t \mid X) = \sum_{k=1}^{K}\lambda_{k}(t \mid X).
\]

From the overall hazard function we arrive in the overall survival function,
\[
  S(t \mid X) =
  \mathbb{P}[T > t \mid X] =
  \exp\left\{-\int_{0}^{t} \lambda(z \mid X)~\text{d}z\right\},
\]
the second function that compose the subdensity \(f_{k}(t \mid X)\). A
comprehensive reference for all these definitions is the book of
\citeonline{kalb&prentice}.

Until this point, we were talking about a general CIF's definition. We
need now a precise framework telling how to take into consideration our
clustered/family structure. We use the same CIF specification of
\citeonline{SCHEIKE}, i.e. the approach that motivated this thesis.

For two competing causes of failure, the cause-specific CIFs are
specified in the following manner,
\begin{equation}
  F_{k} (t \mid X, u_{1}, u_{2}, \eta_{k}) =
  \underbrace{\pi_{k}(X, u_{1}, u_{2})}_{
    \substack{\text{cluster-specific}\\\text{risk level}}}\times
  \underbrace{\Phi[w_{k} g(t) - X^{\top}\gamma_{k} - \eta_{k}]}_{
    \substack{\text{cluster-specific}\\\text{failure time trajectory}}
  }, \quad t > 0, \quad k = 1,~2.
  \label{eq:cif}
\end{equation}
i.e. as a product of a cluster-specific risk level and a
cluster-specific failure time trajectory, resulting in a
cluster-specific CIF.

What makes the components in \autoref{eq:cif} cluster-specific are
\(\bm{u} = \{u_{1}, u_{2}\}\) and \(\bm{\eta} = \{\eta_{1},
\eta_{2}\}\), Gaussian distributed latent effects with zero mean and
potentially correlated, i.e.
\[
  \begin{bmatrix} u_{1}\\u_{2}\\\eta_{1}\\\eta_{2} \end{bmatrix} \sim
  \mathcal{N} \left(\begin{bmatrix} 0\\0\\0\\0\end{bmatrix},
    \begin{bmatrix}
      \sigma_{u_{1}}^{2}&
      \text{cov}(u_{1},~u_{2})&
      \text{cov}(u_{1},~\eta_{1})&\text{cov}(u_{1},~\eta_{2})\\
      &\sigma_{u_{2}}^{2}&
      \text{cov}(u_{2},~\eta_{1})&\text{cov}(u_{2},~\eta_{2})\\
      &&\sigma_{\eta_{1}}^{2}&\text{cov}(\eta_{1},~\eta_{2})\\
      &&&\sigma_{\eta_{2}}^{2}
    \end{bmatrix}\right).
\]

The cluster-specific survival function is given as \(S(t \mid X, \bm{u},
\bm{\eta}) = 1 - F_{1} (t \mid X, \bm{u}, \eta_{1}) - F_{2} (t \mid X,
\bm{u}, \eta_{2})\).

Since we use the same CIF specification of \citeonline{SCHEIKE}, the
following descriptions and details are essentially the same encountered
in the paper.

Focusing first on the second component of \autoref{eq:cif}. The
cluster-specific failure time trajectory
\[
  \Phi[w_{k} g(t) - X^{\top}\gamma_{k} - \eta_{k}],
  \quad t > 0, \quad k = 1, ~2,
\]
where \(\Phi(\cdot)\) is the cumulative distribution function of a
standard Gaussian distribution.

Instead of \(w_{k} g(t)\), in \citeonline{SCHEIKE} is specified
\(\alpha_{k}(g(t))\), where \(\alpha_{k}(\cdot)\) are monotonically
increasing functions known up to a finite-dimensional parameter vector,
\(w_{k}\). Examples are monotonically increasing B-spline or piecewise
lienar functions. However, to try to simplify the model structure we
consider just the finite-dimensional parameter vector. The bottom line
is that the authors do the same approach in their applications.

With regard to the function \(g(t)\), it plays a crucial role since the
separation of the CIF in \autoref{eq:cif} is only possible with it. A
time \(t\) transformation given by
\[
  g(t) = \text{arctanh}\left(\frac{t - \delta/2}{\delta/2}\right),
  \quad t\in~]0,~\delta[, \quad g(t)\in~]-\infty,~\infty[,
\]
where \(\delta\) depends on the data and cannot exceed the maximum
observed follow-up time \(\tau\), i.e. \(\delta \leq \tau\). With this
transformation, based on a Fisher transformation, the value of the
cluster-specific failure time trajectory is equal 1, at time \(\delta\).
Consequently, \(F_{k} (\delta \mid X, \bm{u}, \eta_{k}) = \pi_{k}(X \mid
\bm{u})\) and, we can interpret \(\pi_{1}(X \mid \bm{u})\) and
\(\pi_{2}(X \mid \bm{u})\) as the cause-specific cluster-specific risk
levels, at time \(\delta\).

The cluster-specific risk levels are modeled by a multinomial logistic
regression model with latent effects, i.e.
\begin{equation}
  \pi_{k}(X, \bm{u}) =
  \frac{\exp\{X^{\top}\beta_{k} + u_{k}\}}{1 +
    \exp\{X^{\top}\beta_{1} + u_{1}\} +
    \exp\{X^{\top}\beta_{2} + u_{2}\}}, \quad k = 1,~2,
  \label{eq:risklevel}
\end{equation}
where \(\beta_{k}\)'s are the parameters responsible for quantifying the
impact of the covariates in the cause-specific risk levels. For
individuals from the same chuster/family, at the same time point, the
\(\beta_{k}\)s have the well-known odds ratio interpretation.

The \(\gamma_{k}\)'s are the parameters responsible for quantifying the
impact of the covariates in the cause-specific failure time
trajectories, i.e. the shape of the cumulative incidence, and
consequently how quickly the cluster-specific risk levels observed at
time \(\delta\) are reached. The fact that \(\gamma_{k}\) enters
negatively in the cluster-specific failure time trajectory makes that a
negative value causes an advance towards the cluster-specific risk
level, whereas a covariate with a positive effect causes a delay.

Within-cluster dependence is induced by the latent effects in \(\bm{u}\)
and \(\bm{\eta}\), but they don't have an easy interpretation. To help
in the discussion, \autoref{fig:cif} illustrates the cluster-specific
CIF for a given failure cause, let's call it failure cause 1 (in total
we have two).

\begin{figure}[H]
  % \vspace{0.35cm}
  \setlength{\abovecaptionskip}{.0001pt}
  \caption{ILLUSTRATION OF A CLUSTER-SPECIFIC CUMULATIVE INCIDENCE
    FUNCTION (CIF), PROPOSED BY \citeonline{SCHEIKE}, FOR A GIVEN
    FAILURE CAUSE 1. FROM A CONFIGURATION WITH \(X = 1\) FOR ALL
    SUBJECTS AND WITH \(\beta_{1} = -1.9\), \(\beta_{2} = -0.2\),
    \(\gamma_{1} = 1\), \(w_{1} = 3\) AND \(u_{2} = 0\). THE VARIATION
    BETWEEN FRAMES IS GIVEN BY THE LATENT EFFECTS \(u_{1}\) AND
    \(\eta_{1}\)}
  \vspace{0.425cm} \centering
  \includegraphics[width=\textwidth]{cif-1.png}
  \\
  \vspace{0.45cm}
  \begin{footnotesize}
    SOURCE: The author (2020).
  \end{footnotesize}
  \label{fig:cif}
\end{figure}

The latent effects \(u_{1}\) and \(u_{2}\) always appear together in the
cluster-specific risk level, as consequency they have a joint effect on
the cumulative incidence of both causes. Nevertheless, as we can see in
\autoref{fig:cif}, an increase in \(u_{k}\) will increase the risk of
failure from cause \(k\) and vice versa. The interpretation of
\(\text{cov}(\eta_{1},~\eta_{2})\) and \(\text{cov}(u_{1},~u_{2})\) is
more or less straightforward. With regard to
\(\text{cov}(u_{k},~\eta_{k})\), a negative correlation between
\(\eta_{k}\) and \(u_{k}\) imply that when \(\eta_{k}\) decreases,
\(u_{k}\) increases and conversely when \(\eta_{K}\) increases,
\(u_{k}\) decreases. In other words, an increased risk level is reached
quickly and a decreased risk level is reached later, respectively.

Practical situations with a positive within-cause correlation are hard
to find, i.e. where an increased risk level is associated with a late
onset and vice versa. However, a positive cross-cause correlation
between \(\eta\) and \(u\) sounds more realistic. i.e. where late onset
of one failure cause is associated with a high absolute risk of another
failure cause.

The latent effects are assumed independent across clusters and shared by
individuals within the same cluster/family.

\section{MODEL SPECIFICATION}
\label{cap:modelitself}

Our generalized linear mixed model (GLMM) is specified in the following
fashion. For two competing causes of failure, a subject \(i\), with
cluster \(j\), in the time \(t\), we have
\begin{align}
  y_{i j t} \mid \{u_{1j},~u_{2j},~\eta_{1j},~\eta_{2j}\}&\sim
  \text{Multinomial}(p_{1ijt},~p_{2ijt},~p_{3ijt})\nonumber\\
  \nonumber\\
  \begin{bmatrix} u_{1}\\u_{2}\\\eta_{1}\\\eta_{2} \end{bmatrix}&\sim
  \mathcal{N} \left(\begin{bmatrix} 0\\0\\0\\0\end{bmatrix},
  \begin{bmatrix}
    \sigma_{u_{1}}^{2}&
    \text{cov}(u_{1},~u_{2})&
    \text{cov}(u_{1},~\eta_{1})&\text{cov}(u_{1},~\eta_{2})\\
    &\sigma_{u_{2}}^{2}&
    \text{cov}(u_{2},~\eta_{1})&\text{cov}(u_{2},~\eta_{2})\\
    &&\sigma_{\eta_{1}}^{2}&\text{cov}(\eta_{1},~\eta_{2})\\
    &&&\sigma_{\eta_{2}}^{2}
  \end{bmatrix}\right)\nonumber\\
  \nonumber\\
  p_{kijt} &=
  \frac{\partial}{\partial t}F_{k} (t \mid X, u_{1}, u_{2}, \eta_{k})
  \nonumber\\
  &= \frac{\exp\{\bm{x}_{kij}\bm{\beta}_{ki} + u_{kj}\}}{
    1 + \sum_{m=1}^{K-1}\exp\{\bm{x}_{mij}\bm{\beta}_{mi} + u_{mj}\}}
  \label{eq:model}\\
  &\times w_{k}\frac{\delta}{2\delta t - 2t^{2}}~
  \phi\left(
    w_{k}
    \text{arctanh}\left(\frac{t-\delta/2}{\delta/2}\right)
    - \bm{x}_{kij}\bm{\gamma}_{ki} - \eta_{kj}
    \right),\nonumber\\ k = 1,~2.\nonumber
\end{align}

The chosen link function to represent the probabilities is given by the
derivative w.r.t. time \(t\) of the cluster-specific CIF. The choice of
a multinomial logistic regression model ensures that the sum of the
predicted cause-specific CIFs does not exceed 1.

Considering two competing causes of failure, we have a multinomial with
three classes. The third class exists to handle the censorship and its
probability is given by the complementary to reach 1. This framework in
\autoref{eq:model} results in what we call multiGLMM, a multinomial
GLMM.

For a random sample, the corresponding marginal likelihood functions in
given by
\begin{align}
  L(\bm{\theta}~;~y)
  &= \prod_{j=1}^{J}~\int_{\Re^{4}}
    \pi(y_{j} \mid \bm{r}_{j})\times\pi(\bm{r}_{j})~\text{d}\bm{r}_{j}
    \nonumber\\
  &= \prod_{j=1}^{J}~\int_{\Re^{4}}
    \Bigg\{
    \underbrace{\prod_{i=1}^{n_{j}}~\prod_{t=1}^{n_{ij}}
    \Bigg(
    \frac{(\sum_{k=1}^{K}y_{kijt})!}{y_{1ijt}!~y_{2ijt}!~y_{3ijt}!}~
    \prod_{k=1}^{K} p_{kijt}^{y_{kijt}}
    \Bigg)}_{\substack{\text{fixed effect component}}}
  \Bigg\}\times\nonumber\\
  &\hspace{2cm}\underbrace{
    (2\pi)^{-2} |\Sigma|^{-1/2} \exp
    \left\{-\frac{1}{2}\bm{r}_{j}^{\top} \Sigma^{-1} \bm{r}_{j}\right\}
    }_{\substack{\text{latent effect component}}}
    \text{d}\bm{r}_{j}\nonumber\\
  &= \prod_{j=1}^{J}~\int_{\Re^{4}}
    \Bigg\{
    \underbrace{\prod_{i=1}^{n_{j}}~\prod_{t=1}^{n_{ij}}
    \prod_{k=1}^{K} p_{kijt}^{y_{kijt}}
    }_{\substack{\text{fixed effect}}}
  \Bigg\}\underbrace{
  (2\pi)^{-2} |\Sigma|^{-1/2} \exp
  \left\{-\frac{1}{2}\bm{r}_{j}^{\top} \Sigma^{-1} \bm{r}_{j}\right\}
  }_{\substack{\text{latent effect component}}}
  \text{d}\bm{r}_{j}\label{eq:loglik},
\end{align}
where \(\bm{\theta} = [\bm{\beta}~\bm{\gamma}~\bm{w}~\bm{\sigma^{2}}~
\bm{\varrho}]^{\top}\) is the parameters vector to be maximized. In our
framework, a subject can fail from just one competing cause or get
censor, at a given time. Thus, the fraction of factorials in the fixed
effect component is made only by 0's and 1's. Finally, returning the
value 1 .The matrix \(\Sigma\) is the variance-covariance matrix, which
components are given by \(\bm{\sigma}^{2}\) and \(\bm{\varrho}\).

Now, \autoref{eq:loglik} in words. To each cluster (family) \(j\) we
have a product of two components. The fixed effect component, given by a
multinomial distribution with its probabilities specified through the
cluster-specific CIF (\autoref{eq:cif}) and, the latent effect
component, given by a multivariate Gaussian distribution.

To each subject \(i\) that composes a cluster \(j\) we have its specific
fixed effects contribution. The likelihood in \autoref{eq:loglik} is the
most general as possible, allowing for repeated measures to each
subject. Since all subjects of a given cluster shares the same latent
effect, we have just one latent effect contribution multiplying the
product of fixed effects contribution. As we don't observe the latent
effect variables, \(\bm{r}_{j}\), we integrate out in it. With two
competing causes of failure, we have four latent effects (a multivariate
Gaussian distribution in four dimensions). As consequence, for each
cluster, we approximate an integral in four dimensions. The product of
these approximated integrals results in the called marginal likelihood,
to be maximized in \(\bm{\theta}\).

% END ==================================================================