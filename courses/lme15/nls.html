<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Paulo Justiniano Ribeiro Jr Henrique Aparecido Laureano" />


<title>Ajuste de modelos não lineares</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Ajuste de modelos não lineares</h1>
<h4 class="author"><em><a href="http://leg.ufpr.br/~paulojus/">Paulo Justiniano Ribeiro Jr</a><br /><a href="http://lattes.cnpq.br/2224901552085090">Henrique Aparecido Laureano</a></em></h4>
<h4 class="date"><em>Setembro de 2015</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#exemplo-o-modelo-de-van-genutchen">Exemplo: o modelo de van Genutchen</a></li>
<li><a href="#ajustando-um-modelo-a-varios-conjuntos-de-dados">Ajustando um modelo a vários conjuntos de dados</a></li>
<li><a href="#combinando-ajustes">Combinando ajustes</a></li>
</ul>
</div>

<style type="text/css">
#TOC {
  margin: 0 145px;
}
</style>
<p>Modelos não lineares permitem o ajuste de relações mais complexas que relações lineares ou linearizáveis entre quantidades de interesse. Em muitos casos tais modelos tem a sua forma funcional específica para o problema sendo tratado, relacionada a algum mecanismo (biológico, físico, etc) inerente ao processo em questão.</p>
<p>Nesta seção vamos ilustrar com dados da área de física de solos o ajuste de modelos não lineares utilizando a função <span class="math">\(\texttt{nls()}\)</span>, cujo é um acrônimo para <em>non-linear least squares</em>. Esta função é bastante flexível e incorpora diversas opções para fazer ajustes incluindo características do modelo, tipo e controle dos algorítmos disponíveis.</p>
<p>Diferentemente dos modelos lineares, o ajuste de modelos não lineares não permite que as expressões dos estimadores dos parâmetros desconhecidos do modelo sejam obtidas analiticamente sendo portanto necessário o uso de métodos númericos. Inicialmente mostramos um ajuste feito de forma “ingênua” (<em>naïve</em>), declarando apenas a função e valores iniciais. Tal procedimento, embora simples, pode se ineficiente para o uso de métodos numéricos. Entretanto, o ajuste com <span class="math">\(\texttt{nls()}\)</span> pode incorporar procedimentos que tendem a aprimorar o comportamento dos métodos numéricos tais como o fornecimento de funções que informem sobre a derivada do modelo sendo ajustado, inicialização automática com valores iniciais obtidos automaticamente, linearização parcial do modelo, além da escolha e calibragem dos algorítmos. O objetivo destas notas não é o de investigar todas estas opções, mas apenas fornecer os elementos iniciais para ilustrar a possibilidade de se obter tais resultados usando o <span class="math">\(\texttt{R}\)</span>.</p>
<hr />
<div id="exemplo-o-modelo-de-van-genutchen" class="section level1">
<h1>Exemplo: o modelo de van Genutchen</h1>
<p>Este exemplo mostra o ajuste de um modelo não linear. Primeiro discutimos como efetuar um único ajuste para um conjunto de dados e algumas sugestões para examinar resultados. Ao final mostramos como efetuar vários ajustes de uma só vez de forma eficiente e extrair alguns resultados de particular interesse.</p>
<p>O exemplo mostrado aqui foi motivado por um questão levantada pelo Prof. Álvaro Pires da Silva do Departamento de Ciência do Solo da <strong><em>ESALQ/USP</em></strong> e refere-se ao ajuste da equação de van Genutchen para a <em>curva de retenção de água no solo</em> (ou <em>curva de retenção de água no solo</em>).</p>
<p>Informalmente falando, a equação de van Genutchen é um dos modelos matemáticos utilizados para descrever a curva característica de água no solo que caracteriza a armazenagem de água através de relação entre a umidade e o potencial matricial. Para determinação da curva característica de água o procedimento usual é o de se tomar uma amostra que é submetida a diferentes tensões em condições de laboratório. Para cada tensão aplicada a amostra perde parte do conteúdo de água e mede-se a umidade residual na amostra. A partir dos pares pontos com valores medidos de tensão e umidade, obtem-se a curva de retenção de água no solo que descreve a variação da umidade em função dos valores de tensão. O modelo de van Genutchen é dado pela seguinte equação:</p>
<blockquote>
<p><span class="math">\[ \theta = \theta_{R} + (\theta_{S} - \theta_{R}) \left[ \frac{1}{1 + (\alpha \Psi_{m})^{n}} \right]^{1 - (1/n)} \]</span></p>
</blockquote>
<p>em que <span class="math">\(\Psi_{m}\)</span> é o potencial matricial aplicado à amostra e <span class="math">\(\theta\)</span> é a umidade volumétrica medida na amostra. O parâmetros desconhecidos do modelo modelo são <span class="math">\(\theta_{S}\)</span> e <span class="math">\(\theta_{R}\)</span> que correspondem à umidade volumétrica na saturação e residual, respectivamente, <span class="math">\(\alpha\)</span> e <span class="math">\(n\)</span> que definem o formato da curva sendo que o primeiro representa o inverso do potencial de entrada de ar e o segundo é um índice da distribuição dos tamanhos de poros. Portanto são obtidos dados para os pares de pontos <span class="math">\((\Psi_{m}, \theta)\)</span> e <span class="math">\((\theta_{S}, \theta_{R}, \alpha, n)\)</span> são parâmetros desconhecidos a serem estimados e que caracterizam a curva de retenção.</p>
<p>Para exemplificar o ajuste utilizamos dados cedidos pelo Prof. Álvaro que podem ser obtidos usando o comando mostrado a seguir. Este conjunto de dados refere-se a apenas duas amostras que são um subconjunto dos dados originais que contém diversas amostras. O objetivo é determinar da curva de retenção de água no solo estimada segundo modelo de van Genutchen para cada uma das amostras. No objeto <span class="math">\(\texttt{cra}\)</span> a primeira coluna (<span class="math">\(\texttt{am}\)</span>) indica o número da amostra, a segunda (<span class="math">\(\texttt{pot}\)</span>) o potencial aplicado e a terceira (<span class="math">\(\texttt{u}\)</span>) a umidade do solo. Vemos a seguir que dispomos de 15 pontos medidos da curva de retenção da primeira amostra e 13 para a segunda.</p>
<pre class="sourceCode r"><code class="sourceCode r">cra &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://www.leg.ufpr.br/~paulojus/dados/cra.csv&quot;</span>,
                  <span class="dt">header =</span> <span class="ot">TRUE</span>,
                  <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)
<span class="kw">head</span>(cra)</code></pre>
<pre><code>  am pot      u
1 30  10 0.3071
2 30  19 0.2931
3 30  30 0.2828
4 30  45 0.2753
5 30  63 0.2681
6 30  64 0.2628</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">cra &lt;-<span class="st"> </span><span class="kw">transform</span>(cra,
                 <span class="dt">am =</span> <span class="kw">as.factor</span>(am))
<span class="kw">summary</span>(cra)</code></pre>
<pre><code>  am          pot                u         
 30:15   Min.   :   10.0   Min.   :0.0636  
 41:13   1st Qu.:   58.5   1st Qu.:0.1199  
         Median :  107.5   Median :0.1969  
         Mean   : 2139.8   Mean   :0.1879  
         3rd Qu.: 1550.0   3rd Qu.:0.2436  
         Max.   :26300.0   Max.   :0.3071  </code></pre>
<p>Inicialmente vamos nos concentrar na discussão do ajuste do modelo e para isto, vamos isolar os dados referentes a uma única amostra.</p>
<pre class="sourceCode r"><code class="sourceCode r">(cra30 &lt;-<span class="st"> </span><span class="kw">subset</span>(cra,
                 am ==<span class="st"> </span><span class="dv">30</span>))</code></pre>
<pre><code>   am   pot      u
1  30    10 0.3071
2  30    19 0.2931
3  30    30 0.2828
4  30    45 0.2753
5  30    63 0.2681
6  30    64 0.2628
7  30    75 0.2522
8  30    89 0.2404
9  30   105 0.2272
10 30   138 0.2120
11 30   490 0.1655
12 30  3000 0.1468
13 30  4100 0.1205
14 30  5000 0.1013
15 30 26300 0.0730</code></pre>
<p>No gráfico à esquerda visualizamos os dados de umidade <em>versus</em> pressão aplicada na amostra.</p>
<p>Uma melhor visualização é obtida utilizando-se no eixo horizontal o logarítmo (base 10) dos valores das pressões aplicadas conforme mostrado no gráfico à direita.</p>
<pre class="sourceCode r"><code class="sourceCode r">g1 &lt;-<span class="st"> </span><span class="kw">xyplot</span>(u ~<span class="st"> </span>pot,
             <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;g&quot;</span>),
             <span class="dt">pch =</span> <span class="dv">16</span>,
             <span class="dt">xlab =</span> <span class="kw">expression</span>(Psi[m]),
             <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="kw">expression</span>(theta),
                         <span class="dt">rot =</span> <span class="dv">0</span>),
             <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">35</span>),
             <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">rot =</span> <span class="dv">30</span>)),
             cra30)
g2 &lt;-<span class="st"> </span><span class="kw">xyplot</span>(u ~<span class="st"> </span><span class="kw">log10</span>(pot),
             <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;g&quot;</span>),
             <span class="dt">pch =</span> <span class="dv">16</span>,
             <span class="dt">xlab =</span> <span class="kw">expression</span>(log[<span class="dv">10</span>](Psi[m])),
             <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="kw">expression</span>(theta),
                         <span class="dt">rot =</span> <span class="dv">0</span>),
             <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">35</span>),
             <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">tick.number =</span> <span class="dv">6</span>,
                                    <span class="dt">rot =</span> <span class="dv">30</span>)),
             cra30)
<span class="kw">print</span>(g1,
      <span class="dt">position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>,
                   .<span class="dv">5</span>, <span class="dv">1</span>),
      <span class="dt">more =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(g2,
      <span class="dt">position =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>,
                   <span class="dv">1</span>, <span class="dv">1</span>))</code></pre>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
<p>Portanto, os dados nas colunas <span class="math">\(\texttt{u}\)</span> e <span class="math">\(\texttt{pot}\)</span> do objeto de dados correspondem à <span class="math">\(\theta\)</span> e <span class="math">\(\Psi_{m}\)</span>, e as demais quantidades <span class="math">\((\theta_{R},\theta_{S}, n, \alpha)\)</span> são parâmetros (coeficientes) a serem estimados a partir do ajuste do modelo teórico aos dados. Este é um modelo não linear e pode ser ajustado utilizando o método de mínimos quadrados conforme implementado na <span class="math">\(\texttt{nls()}\)</span>.</p>
<p>A função possui três argumentos obrigatórios: (i) o primeiro é utilizado para declarar a expressão do modelo a ser ajustado, (ii) o segundo informa o objeto contendo o conjunto de dados cujas nomes das colunas relevantes devem ter o mesmo nome utilizado na declaração do modelo e, (iii) valores iniciais para os parâmetros a serem ajustados que devem ser passados por uma <em>named list</em>, isto é, uma lista com nomes dos elementos, e estes nomes também devem coincidir com os utilizados na declaração do modelo. Há argumentos adicionais para controlar o comportamento algorítimo, tal como critério de convergência. A documentação de <span class="math">\(\texttt{nls()}\)</span> fornece mais detalhes.</p>
<p>A escolha dos valores iniciais é crucial e pode influenciar nos resultados do ajuste utilizando métodos numéricos, especialmente em exemplos como este com um pequeno número de dados. Os valores iniciais para <span class="math">\(\theta_{S}\)</span> e <span class="math">\(\theta_{R}\)</span> foram escolhidos inspecionando-se o gráfico e considerando a interpretação destes como valores de saturação e residual de umidade, portanto, considerando-se máximos e mínimos assintóticos para a função. A escolha de valores iniciais para os demais parâmetros é menos óbvia. Uma das formas de se obter tais valores é efetuar um ajuste aproximado, visual por tentativa e erro, traçando-se curvas sobre o gráfico dos dados. O comando a seguir ilustra como fazer tal procedimento a partir do gráfico dos dados originais mostrado anteriormente definindo uma expressão com o modelo de van Genutchen. Os valores foram escolhidos após uma séria de tentativas.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(u ~<span class="st"> </span>pot,
             <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;g&quot;</span>),
             <span class="dt">pch =</span> <span class="dv">16</span>,
             <span class="dt">xlab =</span> <span class="kw">expression</span>(Psi[m]),
             <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="kw">expression</span>(theta),
                         <span class="dt">rot =</span> <span class="dv">0</span>),
             <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">35</span>),
             <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">rot =</span> <span class="dv">30</span>)),
             cra30) +
<span class="st">  </span><span class="kw">layer</span>(<span class="kw">panel.curve</span>(.<span class="dv">05</span> +<span class="st"> </span>(.<span class="dv">35</span> -<span class="st"> </span>.<span class="dv">05</span>) /<span class="st"> </span>( (<span class="dv">1</span> +<span class="st"> </span>(.<span class="dv">1</span> *<span class="st"> </span>x) ^<span class="st"> </span><span class="fl">1.3</span>) ^<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span><span class="dv">1</span> /<span class="st"> </span><span class="fl">1.3</span>) ),
                    <span class="dt">lty =</span> <span class="dv">2</span>))</code></pre>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
<p>Definidos os valores iniciais prossegue-se com o ajuste do modelo conforme os comandos a seguir.</p>
<pre class="sourceCode r"><code class="sourceCode r">fit30 &lt;-<span class="st"> </span><span class="kw">nls</span>(u ~<span class="st"> </span>ur +<span class="st"> </span>(us -<span class="st"> </span>ur) /<span class="st"> </span>( (<span class="dv">1</span> +<span class="st"> </span>(alpha *<span class="st"> </span>pot) ^<span class="st"> </span>n) ^<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span><span class="dv">1</span> /<span class="st"> </span>n) ),
             <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">us =</span> .<span class="dv">35</span>,
                          <span class="dt">ur =</span> .<span class="dv">05</span>,
                          <span class="dt">alpha =</span> .<span class="dv">1</span>,
                          <span class="dt">n =</span> <span class="fl">1.3</span>),
             <span class="dt">data =</span> cra30)
<span class="kw">summary</span>(fit30)</code></pre>
<pre><code>
Formula: u ~ ur + (us - ur)/((1 + (alpha * pot)^n)^(1 - 1/n))

Parameters:
      Estimate Std. Error t value Pr(&gt;|t|)    
us    0.324121   0.017744   18.27 1.41e-09 ***
ur    0.007082   0.071084    0.10    0.922    
alpha 0.038780   0.026202    1.48    0.167    
n     1.211816   0.105207   11.52 1.77e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01104 on 11 degrees of freedom

Number of iterations to convergence: 8 
Achieved convergence tolerance: 7.004e-06</code></pre>
<p>A partir do modelo ajustado pode-se calcular quantidades de interesse. Neste particular exemplo calculamos uma quantidade de interesse prática denotada por <span class="math">\(S\)</span> que é um indicador da qualidade física do solo. Quanto maior o valor de <span class="math">\(S\)</span>, melhor a sua qualidade física.</p>
<pre class="sourceCode r"><code class="sourceCode r">(S &lt;-<span class="st"> </span><span class="kw">with</span>(<span class="kw">as.list</span>(<span class="kw">coefficients</span>(fit30)),
           <span class="kw">abs</span>((-<span class="st"> </span>n *<span class="st"> </span>(us -<span class="st"> </span>ur) *<span class="st"> </span>( ( (<span class="dv">2</span> *<span class="st"> </span>n -<span class="st"> </span><span class="dv">1</span>) /<span class="st"> </span>(n -<span class="st"> </span><span class="dv">1</span>) ) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>n -<span class="st"> </span><span class="dv">2</span>) ) ))))</code></pre>
<pre><code>[1] 0.04097126</code></pre>
<p>Os valores preditos são obtidos de forma direta com <span class="math">\(\texttt{fitted(fit30)}\)</span> ou <span class="math">\(\texttt{predict(fit30)}\)</span>. Para visualização e avaliação do modelo ajustado podemos fazer diferentes gráficos. A Figura abaixo mostra os pontos ajustados no gráfico da esquerda, e a união destes pontos no gráfico da direita. Gráficos de resíduos semelhantes aos obtidos para avaliar ajuste de modelos lineares podem e devem também ser investivados em uma análise. Neste exemplo mostramos o <em>qq-plot</em> dos resíduos e o gráfico dos resíduos <em>versus</em> valores preditos.</p>
<pre class="sourceCode r"><code class="sourceCode r">g1 &lt;-<span class="st"> </span><span class="kw">xyplot</span>(u ~<span class="st"> </span><span class="kw">log10</span>(pot),
             <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;g&quot;</span>),
             <span class="dt">pch =</span> <span class="dv">16</span>,
             <span class="dt">cex =</span> .<span class="dv">8</span>,
             <span class="dt">xlab =</span> <span class="kw">expression</span>(log[<span class="dv">10</span>](Psi)),
             <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="kw">expression</span>(<span class="kw">theta</span>(Umidade, g/g)),
                         <span class="dt">rot =</span> <span class="dv">0</span>),
             <span class="dt">scale =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">tick.number =</span> <span class="dv">6</span>)),
             cra30,
             <span class="dt">key =</span> <span class="kw">list</span>(<span class="dt">corner =</span> <span class="kw">c</span>(<span class="dv">1</span>, .<span class="dv">97</span>),
                        <span class="dt">text =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;observado&quot;</span>, 
                                      <span class="st">&quot;ajustado&quot;</span>)),
                        <span class="dt">points =</span> <span class="kw">list</span>(<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue2&quot;</span>, <span class="dv">2</span>), 
                                      <span class="dt">cex =</span> .<span class="dv">8</span>,
                                      <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">3</span>)))) +
<span class="st">  </span><span class="kw">as.layer</span>(<span class="kw">xyplot</span>(<span class="kw">fitted</span>(fit30) ~<span class="st"> </span><span class="kw">log10</span>(pot),
                  <span class="dt">col =</span> <span class="dv">2</span>,
                  <span class="dt">pch =</span> <span class="dv">3</span>,
                  <span class="dt">cex =</span> .<span class="dv">8</span>,
                  cra30))
g2 &lt;-<span class="st"> </span><span class="kw">xyplot</span>(u ~<span class="st"> </span><span class="kw">log10</span>(pot),
             <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;g&quot;</span>),
             <span class="dt">pch =</span> <span class="dv">16</span>,
             <span class="dt">cex =</span> .<span class="dv">8</span>,
             <span class="dt">xlab =</span> <span class="kw">expression</span>(log[<span class="dv">10</span>](Psi[m])),
             <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="kw">expression</span>(<span class="kw">theta</span>(Umidade, g/g)),
                         <span class="dt">rot =</span> <span class="dv">0</span>),
             <span class="dt">scale =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">tick.number =</span> <span class="dv">6</span>)),
             cra30,
             <span class="dt">key =</span> <span class="kw">list</span>(<span class="dt">corner =</span> <span class="kw">c</span>(<span class="dv">1</span>, .<span class="dv">97</span>),
                        <span class="dt">text =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;observado&quot;</span>, 
                                      <span class="st">&quot;ajustado&quot;</span>)),
                        <span class="dt">points =</span> <span class="kw">list</span>(<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue2&quot;</span>, <span class="dv">2</span>), 
                                      <span class="dt">cex =</span> .<span class="dv">8</span>,
                                      <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">3</span>)))) +
<span class="st">  </span><span class="kw">as.layer</span>(<span class="kw">xyplot</span>(<span class="kw">fitted</span>(fit30) ~<span class="st"> </span><span class="kw">log10</span>(pot),
                  <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,
                  <span class="dt">col =</span> <span class="dv">2</span>,
                  <span class="dt">pch =</span> <span class="dv">3</span>,
                  <span class="dt">cex =</span> .<span class="dv">8</span>,
                  cra30))
rs &lt;-<span class="st"> </span><span class="kw">residuals</span>(fit30)
g3 &lt;-<span class="st"> </span><span class="kw">qqmath</span>(rs,
             <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;g&quot;</span>),
             <span class="dt">pch =</span> <span class="dv">16</span>,
             <span class="dt">xlab =</span> <span class="st">&quot;Quantis teóricos&quot;</span>,
             <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="st">&quot;Quantis </span><span class="ch">\n</span><span class="st"> amostrais&quot;</span>,
                         <span class="dt">rot =</span> <span class="dv">0</span>)) +
<span class="st">  </span><span class="kw">layer</span>(<span class="kw">panel.qqmathline</span>(rs,
                         <span class="dt">col =</span> <span class="st">&quot;dodgerblue2&quot;</span>))
g4 &lt;-<span class="st"> </span><span class="kw">xyplot</span>(rs ~<span class="st"> </span><span class="kw">fitted</span>(fit30),
             <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;g&quot;</span>),
             <span class="dt">pch =</span> <span class="dv">16</span>,
             <span class="dt">cex =</span> .<span class="dv">8</span>,
             <span class="dt">xlab =</span> <span class="st">&quot;Valores ajustados&quot;</span>,
             <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="st">&quot;Resíduos&quot;</span>,
                         <span class="dt">rot =</span> <span class="dv">0</span>)) +
<span class="st">  </span><span class="kw">layer</span>(<span class="kw">panel.abline</span>(<span class="dt">h =</span> <span class="dv">0</span>,
                     <span class="dt">col =</span> <span class="st">&quot;navy&quot;</span>,
                     <span class="dt">lwd =</span> <span class="fl">1.5</span>))
<span class="kw">print</span>(g1,
      <span class="dt">position =</span> <span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>,
                   .<span class="dv">5</span>, <span class="dv">1</span>),
      <span class="dt">more =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(g2,
      <span class="dt">position =</span> <span class="kw">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>,
                   <span class="dv">1</span>, <span class="dv">1</span>),
      <span class="dt">more =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(g3,
      <span class="dt">position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>,
                   .<span class="dv">5</span>, .<span class="dv">5</span>),
      <span class="dt">more =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(g4,
      <span class="dt">position =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>,
                   <span class="dv">1</span>, .<span class="dv">5</span>))</code></pre>
<p><img src="data:image/png;base64,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" title alt style="margin:0 -155px" style="display: block; margin: auto;" /></p>
<p>Para obter uma melhor visualização do modelo ajustado pode-se obter valores na curva ajustada não apenas nos pontos observados, mas em uma sequência de valores ao longo do gráfico como ilustrado a seguir. A Figura à esquerda mostra o modelo definido pelos valores iniciais e o modelo ajustado na escala original. Note que neste exemplo em geral prefere-se a visualização na escala logarítmica do potencial conforme o gráfico da direita. A curva com o modelo ajustado a serem desenhadas sobre o gráfico dos dados são obtidas com comandos a seguir.</p>
<pre class="sourceCode r"><code class="sourceCode r">pp &lt;-<span class="st"> </span><span class="dv">10</span> ^<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="fl">4.5</span>,
               <span class="dt">length.out =</span> <span class="dv">201</span>)
g1 &lt;-<span class="st"> </span><span class="kw">xyplot</span>(u ~<span class="st"> </span>pot,
             <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;g&quot;</span>),
             <span class="dt">pch =</span> <span class="dv">16</span>,
             <span class="dt">xlab =</span> <span class="kw">expression</span>(Psi[m]),
             <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="kw">expression</span>(theta),
                         <span class="dt">rot =</span> <span class="dv">0</span>),
             <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">35</span>),
             <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">rot =</span> <span class="dv">30</span>)),
             <span class="dt">key =</span> <span class="kw">list</span>(<span class="dt">corner =</span> <span class="kw">c</span>(<span class="dv">1</span>, .<span class="dv">97</span>),
                        <span class="dt">text =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;valores iniciais&quot;</span>,
                                      <span class="st">&quot;valores ajustados&quot;</span>)),
                        <span class="dt">lines =</span> <span class="kw">list</span>(<span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="st">&quot;dodgerblue2&quot;</span>), 
                                     <span class="dt">lty =</span> <span class="dv">2</span>:<span class="dv">1</span>)),
             cra30) +
<span class="st">  </span><span class="kw">layer</span>(<span class="kw">panel.curve</span>(.<span class="dv">05</span> +<span class="st"> </span>(.<span class="dv">35</span> -<span class="st"> </span>.<span class="dv">05</span>) /<span class="st"> </span>( (<span class="dv">1</span> +<span class="st"> </span>(.<span class="dv">1</span> *<span class="st"> </span>x) ^<span class="st"> </span><span class="fl">1.3</span>) ^<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span><span class="dv">1</span> /<span class="st"> </span><span class="fl">1.3</span>) ),
                    <span class="dt">lty =</span> <span class="dv">2</span>)) +
<span class="st">  </span><span class="kw">layer</span>(<span class="kw">panel.lines</span>(pp, <span class="kw">predict</span>(fit30, <span class="kw">list</span>(<span class="dt">pot =</span> pp))))
g2 &lt;-<span class="st"> </span><span class="kw">xyplot</span>(u ~<span class="st"> </span><span class="kw">log10</span>(pot),
             <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;g&quot;</span>),
             <span class="dt">pch =</span> <span class="dv">16</span>,
             <span class="dt">cex =</span> .<span class="dv">8</span>,
             <span class="dt">xlab =</span> <span class="kw">expression</span>(log[<span class="dv">10</span>](Psi[m])),
             <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="kw">expression</span>(theta),
                         <span class="dt">rot =</span> <span class="dv">0</span>),
             <span class="dt">scale =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">tick.number =</span> <span class="dv">6</span>,
                                   <span class="dt">rot =</span> <span class="dv">30</span>)),
             cra30) +
<span class="st">  </span><span class="kw">layer</span>(<span class="kw">panel.lines</span>(<span class="kw">log10</span>(pp), <span class="kw">predict</span>(fit30, <span class="kw">list</span>(<span class="dt">pot =</span> pp))))
<span class="kw">print</span>(g1,
      <span class="dt">position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>,
                   .<span class="dv">5</span>, <span class="dv">1</span>),
      <span class="dt">more =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(g2,
      <span class="dt">position =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>,
                   <span class="dv">1</span>, <span class="dv">1</span>))</code></pre>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
<blockquote>
<p>Comentários: é importante lembrar que certos modelos não lineares são <em>parcialmente linearizáveis</em> e neste caso o ajuste pode ser mais preciso e numericamente estável se beneficiando disto para reduzir a dimensão do problema de otimização numérica. Para isto é necessário redefinir a especicifação do modelo e utilizar o argumento <span class="math">\(\texttt{method= &quot; plinear&quot;}\)</span> na <span class="math">\(\texttt{nls()}\)</span>. Neste exemplo em particilar pode-se considerar fazer o ajuste na escala de <span class="math">\(log_{10}(\Psi_{m})\)</span> já que os resultados são tipicamente visualizados desta forma. Isto reduz a escala dos valores das variáveis e também torna o problema mais estável numericamente. Por outro lado, em geral reparametrizações podem mudar a interpretação de alguns parâmetros de modelo. Finalmente cuidados usuais com ajuste de modelos utilizando métodos iterativos devem ser observados, tais como sensibilidade a valores iniciais e verificação de convergência do algorítmo numérico.</p>
</blockquote>
<hr />
</div>
<div id="ajustando-um-modelo-a-varios-conjuntos-de-dados" class="section level1">
<h1>Ajustando um modelo a vários conjuntos de dados</h1>
<p>Vamos considerar uma situação comum na prática onde em geral tem-se várias amostras para as quais deseja-se fazer ajustes individuais como ilustrado anteriormente. É portanto conveniente que isto seja feito de forma automática, sem a necesidade de repetir os passos acima a cada ajuste. Neste exemplo vamos considerar duas amostras, mas o procedimento demostrado a seguir é geral e funcionará igualmente para um maior número de amostras.</p>
<p>Serão mostradas duas soluções. Nesta sessão o ajuste é feito para cada amostra individualmente automatizando várias chamadas da função <span class="math">\(\texttt{nls()}\)</span> através do <span class="math">\(\texttt{lapply()}\)</span> emulando o comportamento das várias chamadas em um <em>loop</em>. Na próxima sessão será mostrado como obter os todos os ajustes com uma única chamada da <span class="math">\(\texttt{nls()}\)</span>. Ilustramos ambos os casos porque a forma mais adequada vai depender de situação em questão e dos objetivos da análise.</p>
<p>Começamos definindo uma função que contém uma chamada da <span class="math">\(\texttt{nls()}\)</span>, como acima. Nesta função estamos incluindo um argumento <span class="math">\(\texttt{ini}\)</span> para passar valores iniciais que caso não fornecido assumirá os valores indicados. A seguir utilizamos a função <span class="math">\(\texttt{by()}\)</span> para proceder o ajuste para cada amostra individualmente. Esta função retorna uma lista com dois elementos, um para cada amostra, sendo que cada um deles contém o ajuste do modelo não linear.</p>
<pre class="sourceCode r"><code class="sourceCode r">fit.vG &lt;-<span class="st"> </span>function(x, <span class="dt">ini =</span> <span class="kw">list</span>(<span class="dt">us =</span> .<span class="dv">3</span>,
                                 <span class="dt">ur =</span> .<span class="dv">02</span>,
                                 <span class="dt">alpha =</span> .<span class="dv">05</span>,
                                 <span class="dt">n =</span> <span class="fl">1.3</span>))
  nlsfit &lt;-<span class="st"> </span><span class="kw">nls</span>(u ~<span class="st"> </span>ur +<span class="st"> </span>(us -<span class="st"> </span>ur) /<span class="st"> </span>(<span class="dv">1</span> +<span class="st"> </span>(alpha *<span class="st"> </span>pot) ^<span class="st"> </span>n) ^<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span><span class="dv">1</span> /<span class="st"> </span>n),
                <span class="dt">start =</span> ini,
                <span class="dt">data =</span> x)
allfits &lt;-<span class="st"> </span><span class="kw">by</span>(cra, cra$am, fit.vG)
<span class="kw">names</span>(allfits)</code></pre>
<pre><code>[1] &quot;30&quot; &quot;41&quot;</code></pre>
<p>Neste caso, o objeto resultante <span class="math">\(\texttt{allfits}\)</span> é uma <em>lista de listas</em> e portanto podemos usar funções como <span class="math">\(\texttt{lapply()}\)</span>, <span class="math">\(\texttt{sapply()}\)</span> ou similares para extrair resultados de interesse. Note que a primeira retorna sempre uma lista, enquanto que a segunda “simplifica” o objeto resultante se possível. Por exemplo, quando extraindo coeficientes a função retorna uma matrix 4 × 2, já que para cada uma das duas amostras são extraidos quatro coeficientes.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(allfits, summary)</code></pre>
<pre><code>$`30`

Formula: u ~ ur + (us - ur)/(1 + (alpha * pot)^n)^(1 - 1/n)

Parameters:
      Estimate Std. Error t value Pr(&gt;|t|)    
us    0.324120   0.017744   18.27 1.41e-09 ***
ur    0.007082   0.071084    0.10    0.922    
alpha 0.038780   0.026202    1.48    0.167    
n     1.211816   0.105207   11.52 1.77e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01104 on 11 degrees of freedom

Number of iterations to convergence: 6 
Achieved convergence tolerance: 7.997e-06


$`41`

Formula: u ~ ur + (us - ur)/(1 + (alpha * pot)^n)^(1 - 1/n)

Parameters:
       Estimate Std. Error t value Pr(&gt;|t|)    
us     0.243148   0.009446  25.741 9.71e-10 ***
ur    -0.122402   0.171615  -0.713    0.494    
alpha  0.035928   0.022324   1.609    0.142    
n      1.113320   0.079473  14.009 2.04e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.006207 on 9 degrees of freedom

Number of iterations to convergence: 7 
Achieved convergence tolerance: 9.457e-06</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(allfits, coef)</code></pre>
<pre><code>$`30`
         us          ur       alpha           n 
0.324120323 0.007082248 0.038779880 1.211816160 

$`41`
         us          ur       alpha           n 
 0.24314784 -0.12240201  0.03592828  1.11332042 </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(allfits, coef)</code></pre>
<pre><code>               30          41
us    0.324120323  0.24314784
ur    0.007082248 -0.12240201
alpha 0.038779880  0.03592828
n     1.211816160  1.11332042</code></pre>
<p>Quando ajustamos o modelo apenas para uma das amostras mostramos como calcular o índice <span class="math">\(S\)</span> de qualidade física do solo a partir dos coeficientes estimados. Vamos então aqui obter este índice para cada uma das amostras. Para isto simplesmente definimos uma função que recebe o modelo ajustado e usa os coeficiente para calcular o valor de <span class="math">\(S\)</span>. Passamos o objeto (lista) contendo todos os ajustes e a função que calcula <span class="math">\(S\)</span> para <span class="math">\(\texttt{sapply()}\)</span> que neste caso vai simplificar o resultado para formato de um vetor, já que a função calculaS retorna um escalar para cada amostra.</p>
<pre class="sourceCode r"><code class="sourceCode r">calculaS &lt;-<span class="st"> </span>function(fit)
  <span class="kw">with</span>(<span class="kw">as.list</span>(<span class="kw">coef</span>(fit)), <span class="kw">abs</span>((-<span class="st"> </span>n *<span class="st"> </span>(us -<span class="st"> </span>ur) *<span class="st"> </span>( ( (<span class="dv">2</span> *<span class="st"> </span>n -<span class="st"> </span><span class="dv">1</span>) /<span class="st"> </span>(n -<span class="st"> </span><span class="dv">1</span>) ) ^<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span>n -<span class="st"> </span><span class="dv">2</span>) ))))
(Sall &lt;-<span class="st"> </span><span class="kw">sapply</span>(allfits, calculaS))</code></pre>
<pre><code>        30         41 
0.04097127 0.02950320 </code></pre>
<p>Finalmente, para encerrar este exemplo, vamos mostrar uma possível forma de combinar a visualização dos ajustes em um único gráfico. Começamos definindo uma sequência de valores para os quais queremos visualizar os ajustes. Armazenamos os valores preditos para cada amostra no objeto <span class="math">\(\texttt{allpred}\)</span> e optamos aqui por mostrar os ajustes para as duas amostras no mesmo gráfico.</p>
<pre class="sourceCode r"><code class="sourceCode r">lpsimax &lt;-<span class="st"> </span><span class="kw">with</span>(cra, <span class="kw">max</span>(<span class="kw">log</span>(pot)))
pp &lt;-<span class="st"> </span><span class="dv">10</span> ^<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, lpsimax,
               <span class="dt">length.out =</span> <span class="dv">501</span>)
allpred &lt;-<span class="st"> </span><span class="kw">lapply</span>(allfits, predict, <span class="kw">list</span>(<span class="dt">pot =</span> pp))
<span class="kw">xyplot</span>(u ~<span class="st"> </span><span class="kw">log10</span>(pot),
       <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;g&quot;</span>),
       <span class="dt">xlab =</span> <span class="kw">expression</span>(log[<span class="dv">10</span>](Psi)),
       <span class="dt">ylab =</span> <span class="kw">list</span>(<span class="dt">label =</span> <span class="kw">expression</span>(<span class="kw">theta</span>(Umidade, g/g)),
                   <span class="dt">rot =</span> <span class="dv">0</span>),
       <span class="dt">scale =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">tick.number =</span> <span class="dv">6</span>)),
       cra) +
<span class="st">  </span><span class="kw">layer</span>(<span class="kw">with</span>(cra, <span class="kw">panel.text</span>(<span class="kw">log10</span>(pot), u, <span class="kw">as.character</span>(am), <span class="dt">cex =</span> .<span class="dv">75</span>))) +
<span class="st">  </span><span class="kw">layer</span>(<span class="kw">lapply</span>(allpred, function(yp)
    <span class="kw">llines</span>(<span class="kw">log10</span>(pp), yp)))</code></pre>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="combinando-ajustes" class="section level1">
<h1>Combinando ajustes</h1>
<p>Na sessão anterior obtivemos o ajusta para cada amostra separadamente fazendo várias chamadas à função <span class="math">\(\texttt{nls()}\)</span>. Isto pode ser adequado quando deseja-se de fato ajustes individuais e se, por um lado são efetuadas várias chamadas à função, por outro o número de dados em cada uma delas é pequeno. Uma forma alternativa de obter parâmetros para cada amostra, e talvez mais eficiente que a mostrada anteriormente é discutida a seguir.</p>
<p>Nesta sessão vamos considerar fazer todos os ajustes de só vez, isto é em uma única chamada da <span class="math">\(\texttt{nls()}\)</span> que portanto vai utilizar todos os dados de todas as amostras. Além do aspecto computacional, isto pode ser interessante pois permite comparar e testar hipóteses para escolha entre diferentes modelos alternativos para explicar os dados. Exemplificamos tal procedimento a seguir iniciando com um modelo para cada amostra e comparando com um modelo que assume que os parâmetros <span class="math">\((\alpha, n)\)</span> são comuns entre as amostras. Neste caso interpreta-se que cada amostra informa sobre os respectivos valores para <span class="math">\((\theta_{S}, \theta_{R})\)</span> enquanto que todas as amostras conjuntamente informam sobre <span class="math">\((\alpha, n)\)</span>. Após ajustar os modelos “candidatos” podemos fazer uma comparação formal dos ajustes através da <span class="math">\(\texttt{anova()}\)</span>, o que não seria possível ajustando os modelos separadamente como mostrado sessão anterior. Os dois ajustes são mostrados a seguir, o seletor <span class="math">\([]\)</span> é usado para indicar que os dados são tratados em grupos definidos por <span class="math">\(\texttt{am}\)</span>. No caso do modelo com parâmetros distintos informamos oito valores iniciais para os parâmetros.</p>
<pre class="sourceCode r"><code class="sourceCode r">(mod0 &lt;-<span class="st"> </span><span class="kw">nls</span>(u ~<span class="st"> </span>ur[am] +<span class="st"> </span>(us[am] -<span class="st"> </span>ur[am]) *<span class="st"> </span>( <span class="dv">1</span> /<span class="st"> </span>( <span class="dv">1</span> +<span class="st"> </span>(alpha[am] *<span class="st"> </span>pot) ^<span class="st"> </span>n[am] ) ) ^<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span><span class="dv">1</span> /<span class="st"> </span>n[am]),
             <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">us =</span> <span class="kw">c</span>(.<span class="dv">3</span>, .<span class="dv">3</span>),
                          <span class="dt">ur =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                          <span class="dt">alpha =</span> <span class="kw">c</span>(.<span class="dv">04</span>, .<span class="dv">04</span>),
                          <span class="dt">n =</span> <span class="kw">c</span>(<span class="fl">1.25</span>, <span class="fl">1.25</span>)),
             cra))</code></pre>
<pre><code>Nonlinear regression model
  model: u ~ ur[am] + (us[am] - ur[am]) * (1/(1 + (alpha[am] * pot)^n[am]))^(1 -     1/n[am])
   data: cra
      us1       us2       ur1       ur2    alpha1    alpha2        n1 
 0.324120  0.243148  0.007085 -0.122402  0.038779  0.035928  1.211820 
       n2 
 1.113320 
 residual sum-of-squares: 0.001688

Number of iterations to convergence: 6 
Achieved convergence tolerance: 4.637e-06</code></pre>
<p>Para ajuste assumindo valores comuns para os parâmetros <span class="math">\(\alpha\)</span> e <span class="math">\(n\)</span> não utilizamos o indicados de grupos para estes parâmetros e informamos apenas um valor inicial para cada um deles.</p>
<pre class="sourceCode r"><code class="sourceCode r">(mod1 &lt;-<span class="st"> </span><span class="kw">nls</span>(u ~<span class="st"> </span>ur[am] +<span class="st"> </span>(us[am] -<span class="st"> </span>ur[am]) *<span class="st"> </span>( <span class="dv">1</span> /<span class="st"> </span>( <span class="dv">1</span> +<span class="st"> </span>(alpha *<span class="st"> </span>pot) ^<span class="st"> </span>n ) ) ^<span class="st"> </span>( <span class="dv">1</span> -<span class="st"> </span><span class="dv">1</span> /<span class="st"> </span>n ),
             <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">us =</span> <span class="kw">c</span>(.<span class="dv">3</span>, .<span class="dv">3</span>),
                          <span class="dt">ur =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                          <span class="dt">alpha =</span> .<span class="dv">04</span>,
                          <span class="dt">n =</span> <span class="fl">1.25</span>),
             cra))</code></pre>
<pre><code>Nonlinear regression model
  model: u ~ ur[am] + (us[am] - ur[am]) * (1/(1 + (alpha * pot)^n))^(1 -     1/n)
   data: cra
     us1      us2      ur1      ur2    alpha        n 
 0.32106  0.24870 -0.03056 -0.02759  0.03994  1.17195 
 residual sum-of-squares: 0.001846

Number of iterations to convergence: 5 
Achieved convergence tolerance: 2.012e-06</code></pre>
<p>Neste exemplo temos então um modelo inicial com oito e outro mais parcimonioso com apenas seis parâmetros e utilizamos um teste formal para orientar a escolha de modelo, que neste caso indica que o modelo mais parcimonioso com parâmetros comuns explica os dados satisfatóriamente.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(mod1, mod0)</code></pre>
<pre><code>Analysis of Variance Table

Model 1: u ~ ur[am] + (us[am] - ur[am]) * (1/(1 + (alpha * pot)^n))^(1 - 1/n)
Model 2: u ~ ur[am] + (us[am] - ur[am]) * (1/(1 + (alpha[am] * pot)^n[am]))^(1 - 1/n[am])
  Res.Df Res.Sum Sq Df     Sum Sq F value Pr(&gt;F)
1     22  0.0018462                             
2     20  0.0016884  2 0.00015786   0.935 0.4091</code></pre>
<hr />
<hr />
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
