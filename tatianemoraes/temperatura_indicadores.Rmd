---
title: "Indicadores de malária: Temperatura"
author: "Tatiane Moraes e 
         [Henrique Laureano](https://henriquelaureano.github.io/)"
date: "*Last modification on* `r Sys.time()`"
output:
  html_document:
    toc: true
    toc_float: true
---

```{r, echo=FALSE}

if (!requireNamespace('knitr', quietly=TRUE)) install.packages('knitr')
library(knitr)
options(width=100)
knitr::opts_chunk$set(fig.path='figuras_temperatura/',
                      fig.align='center',
                      ## dev=c('pdf', 'png'),
                      warning=FALSE, message=FALSE, prompt=FALSE,
                      echo=FALSE, comment=NA)

```

***

```{r pkgs}

if (!requireNamespace('pacman', quietly=TRUE)) install.packages('pacman')
pacman::p_load(readxl, dplyr, tidyr, devtools, geobr, rlang, purrr,
               ggplot2, patchwork, spdep, kableExtra)
## devtools::install_github('ipeaGIT/geobr', subdir='r-package')
## library(geobr)
source(
    '../../henriquelaureano.github.io/i4p-colors/i4p-palette.R'
)
unique_color <- '#3e4989ff'

```

```{r dat}

temperatura <-
    readxl::read_xlsx('valores_ind_simples_malaria_TM_0805.xlsx',
                      sheet='valores_temperatura_henrique')

temp.chr <- dplyr::select(temperatura,
                          c(`code_muni`, `Município`, `UF`, `Biome`))
temp.num <-
    dplyr::select(temperatura,
                  !c(`code_muni`, `Município`, `UF`, `Biome`))|>
    dplyr::mutate_if(is.character, as.numeric)|>
    dplyr::mutate(
               `Sem acesso ao saneamento adequado`=
                   tidyr::replace_na(
                              `Sem acesso ao saneamento adequado`, 0), 
               `IDH-M`=tidyr::replace_na(`IDH-M`, 0),
               `Turismo Municipal`=
                   tidyr::replace_na(`Turismo Municipal`, 0),
               `Imigração recente`=
                   tidyr::replace_na(`Imigração recente`, 0),
               `Cobertura da Atenção Básica`=
                   tidyr::replace_na(`Cobertura da Atenção Básica`, 0),
               `Acesso a diagnóstico e tratamento`=
                   tidyr::replace_na(
                              `Acesso a diagnóstico e tratamento`, 0),
               `Desflorestamento`=
                   tidyr::replace_na(`Desflorestamento`, 0),
               `População Rural`=tidyr::replace_na(`População Rural`, 0)
           )

temperatura <- cbind(temp.chr, temp.num)

## str(temperatura)

```

```{r results='hide'}

br <- geobr::read_municipality(code_muni='all', year=2018)

```

# Nível 1

***

## Uso e ocupação do solo

> - Assentamentos
> - Mineração
> - Desflorestamento
> - População Rural
> - Corpos d'agua

```{r uso_e_ocupacao_do_solo,fig.width=10}

indicator <- function(data, vars, index=c('median', 'mean', 'pca'))
{
    dat       <- dplyr::select(data,
                               dplyr::all_of(!!rlang::enquo(vars)))
    n         <- nrow(dat)
    dat$index <- switch(
        index,
        'median'=purrr::map_dbl(seq(n), 
                                function(.x)
                                    median(as.numeric(dat[.x, ]))),
        'mean'  =purrr::map_dbl(seq(n),
                                function(.x)
                                    mean  (as.numeric(dat[.x, ]))),
        'pca'   =prcomp(dat)$x[, 1]
    )
    if (index == 'pca')
    {
        index.min <- min(dat$index)
        dat$index <- (dat$index-index.min)/(max(dat$index)-index.min)
    }
    dat <- cbind(temp.chr, dat)
    dat <- dplyr::inner_join(br, dat, by='code_muni')
    return(dat)
}
indicator.map <- function(data, title='Título')
{
    data|>
        ggplot(aes(fill=index))+
        geom_sf(size=0.025)+
        coord_sf(datum=NA)+
        scale_fill_distiller(palette='Spectral',
                             limits=c(0, 1), 
                             breaks=seq(0, 1, by=0.2))+
        labs(title=title)+
        theme_classic(base_size=14)+
        ## theme(plot.title=element_text(face='bold'))+
        guides(fill=guide_colorbar(title=NULL,
                                   barheight=11, barwidth=0.65))
}

dat1.vars <- c("Assentamentos",
               "Mineração",
               "Desflorestamento",
               "População Rural",
               "Corpos d'água")

dat1.median <- indicator(temperatura, dat1.vars, index='median')
dat1.mean   <- indicator(temperatura, dat1.vars, index='mean')
dat1.pca    <- indicator(temperatura, dat1.vars, index='pca')
## str(dat1.median)

p1 <- indicator.map(dat1.median, title='Mediana')
p2 <- indicator.map(dat1.mean  , title='Média')
p3 <- indicator.map(dat1.pca   , title='PCA')

p1 + p2 + p3 +
    patchwork::plot_layout(guides='collect')&
    patchwork::plot_annotation(title='Uso e ocupação do solo',
                               subtitle='Agregação por')&
    theme(plot.title   =element_text(face='bold', size=14),
          plot.subtitle=element_text(size=14))

```

> Com o **teste de Moran** verificamos se existe efeito/correlação
> espacial. Estatísticas maiores que o valor esperado indicam correlação
> espacial positiva. Valores menores indicam correlação negativa.
>
> Em vermelho, tudo que for significativo no nível de 5%.

```{r results='hide'}

get.ZeroPolicyOption()
set.ZeroPolicyOption(TRUE)
get.ZeroPolicyOption()

```

```{r}

morans <- function(data, var)
{
    neigh  <- spdep::poly2nb(data)
    morans <- spdep::moran.test(var,
                                spdep::nb2listw(neigh),
                                alternative='two.sided')
    c(morans$estimate, 'p-value'=morans$p.value)
}
dplyr::bind_rows(morans(dat1.median, dat1.median$index), 
                 morans(dat1.mean  , dat1.mean$index), 
                 morans(dat1.pca   , dat1.pca$index))|>
    dplyr::mutate(var=c('Mediana', 'Média', 'PCA'))|>
    dplyr::relocate(var, .before='Moran I statistic')|>
    kableExtra::kbl(booktabs=TRUE, digits=10)|>
    kableExtra::kable_classic_2(full_width=FALSE)|>
    kableExtra::column_spec(5, bold=TRUE)|>
    kableExtra::row_spec(1:3, bold=TRUE,
                         color='white', background='#D7261E')

```

> Ficamos com o PCA.

```{r uso_e_ocupacao_do_solo_pca}

finalindicator.map <- function(data, title='Título')
{
    data|>
        ggplot(aes(fill=index))+
        geom_sf(size=0.025)+
        coord_sf(datum=NA)+
        scale_fill_distiller(palette='Spectral',
                             limits=c(0, 1), 
                             breaks=seq(0, 1, by=0.1))+
        labs(title=title)+
        theme_classic(base_size=14)+
        theme(plot.title=element_text(face='bold'))+
        guides(fill=guide_colorbar(title=NULL,
                                   barheight=19, barwidth=0.65))
}
finalindicator.map(dat1.pca, title='Uso e ocupação do solo')

```

## Malha rodoviária

> - Presença de rodovias

```{r malha_rodoviaria}

var.map <- function(data, var)
{
    dat <- dplyr::inner_join(br, data, by='code_muni')
    dat|>
        ggplot(aes(fill=!!rlang::ensym(var)))+
        geom_sf(size=0.025)+
        coord_sf(datum=NA)+
        scale_fill_distiller(palette='Spectral',
                             limits=c(0, 1), 
                             breaks=seq(0, 1, by=0.1))+
        labs(title=deparse(substitute(var)))+
        theme_classic(base_size=14)+
        theme(plot.title=element_text(face='bold'))+
        guides(fill=guide_colorbar(title=NULL,
                                   barheight=19, barwidth=0.65))
}
var.map(temperatura, `Presença de rodovias`)

temperatura.br <- dplyr::inner_join(br, temperatura, by='code_muni')

rbind(morans(temperatura.br, temperatura.br$`Presença de rodovias`))|>
    kableExtra::kbl(booktabs=TRUE, digits=10)|>
    kableExtra::kable_classic_2(full_width=FALSE)|>
    kableExtra::column_spec(4, bold=TRUE)|>
    kableExtra::row_spec(1, bold=TRUE,
                         color='white', background='#D7261E')

```

## Serviços de saúde

> - Cobertura atenção básica
> - Acesso a diagnóstico e tratamento

```{r servicos_de_saude,fig.width=10}

dat3.vars <- c("Cobertura da Atenção Básica",
               "Acesso a diagnóstico e tratamento")

dat3.median <- indicator(temperatura, dat3.vars, index='median')
dat3.mean   <- indicator(temperatura, dat3.vars, index='mean')
dat3.pca    <- indicator(temperatura, dat3.vars, index='pca')|>
    dplyr::mutate(index=(1-index))

p1 <- indicator.map(dat3.median, title='Mediana')
p2 <- indicator.map(dat3.mean  , title='Média')
p3 <- indicator.map(dat3.pca   , title='PCA')

p1 + p2 + p3 +
    patchwork::plot_layout(guides='collect')&
    patchwork::plot_annotation(title='Serviços de saúde',
                               subtitle='Agregação por')&
    theme(plot.title   =element_text(face='bold', size=14),
          plot.subtitle=element_text(size=14))

dplyr::bind_rows(morans(dat3.median, dat3.median$index), 
                 morans(dat3.mean  , dat3.mean$index), 
                 morans(dat3.pca   , dat3.pca$index))|>
    dplyr::mutate(var=c('Mediana', 'Média', 'PCA'))|>
    dplyr::relocate(var, .before='Moran I statistic')|>
    kableExtra::kbl(booktabs=TRUE, digits=10)|>
    kableExtra::kable_classic_2(full_width=FALSE)|>
    kableExtra::column_spec(5, bold=TRUE)|>
    kableExtra::row_spec(1:3, bold=TRUE,
                         color='white', background='#D7261E')

```

> ficamos com a mediana.

```{r servicos_de_saude_mediana}

finalindicator.map(dat3.median, title='Serviços de saúde')

```

## Perfil Epidemiológico da Malária

> - IPA
> - Malaria falciparum 

```{r perfil_epidemiologico_da_malaria,fig.width=10}

dat4.vars <- c("IPA",
               "Malária falciparum")

dat4.median <- indicator(temperatura, dat4.vars, index='median')
dat4.mean   <- indicator(temperatura, dat4.vars, index='mean')
dat4.pca    <- indicator(temperatura, dat4.vars, index='pca')

p1 <- indicator.map(dat4.median, title='Mediana')
p2 <- indicator.map(dat4.mean  , title='Média')
p3 <- indicator.map(dat4.pca   , title='PCA')

p1 + p2 + p3 +
    patchwork::plot_layout(guides='collect')&
    patchwork::plot_annotation(title='Perfil Epidemiológico da Malária',
                               subtitle='Agregação por')&
    theme(plot.title   =element_text(face='bold', size=14),
          plot.subtitle=element_text(size=14))

dplyr::bind_rows(morans(dat4.median, dat4.median$index), 
                 morans(dat4.mean  , dat4.mean$index), 
                 morans(dat4.pca   , dat4.pca$index))|>
    dplyr::mutate(var=c('Mediana', 'Média', 'PCA'))|>
    dplyr::relocate(var, .before='Moran I statistic')|>
    kableExtra::kbl(booktabs=TRUE, digits=10)|>
    kableExtra::kable_classic_2(full_width=FALSE)|>
    kableExtra::column_spec(5, bold=TRUE)|>
    kableExtra::row_spec(1:3, bold=TRUE,
                         color='white', background='#D7261E')

```

> Ficamos com o PCA.

```{r perfil_epidemiologico_da_malaria_pca}

finalindicator.map(dat4.pca,
                   title='Perfil Epidemiológico da Malária')

```

## Mobilidade populacional

> - Turismo municipal
> - Imigração recente 

```{r mobilidade_populacional,fig.width=10}

dat5.vars <- c("Turismo Municipal",
               "Imigração recente")

dat5.median <- indicator(temperatura, dat5.vars, index='median')
dat5.mean   <- indicator(temperatura, dat5.vars, index='mean')
dat5.pca    <- indicator(temperatura, dat5.vars, index='pca')

p1 <- indicator.map(dat5.median, title='Mediana')
p2 <- indicator.map(dat5.mean  , title='Média')
p3 <- indicator.map(dat5.pca   , title='PCA')

p1 + p2 + p3 +
    patchwork::plot_layout(guides='collect')&
    patchwork::plot_annotation(title='Mobilidade Populacional',
                               subtitle='Agregação por')&
    theme(plot.title   =element_text(face='bold', size=14),
          plot.subtitle=element_text(size=14))

dplyr::bind_rows(morans(dat5.median, dat5.median$index), 
                 morans(dat5.mean  , dat5.mean$index), 
                 morans(dat5.pca   , dat5.pca$index))|>
    dplyr::mutate(var=c('Mediana', 'Média', 'PCA'))|>
    dplyr::relocate(var, .before='Moran I statistic')|>
    kableExtra::kbl(booktabs=TRUE, digits=10)|>
    kableExtra::kable_classic_2(full_width=FALSE)|>
    kableExtra::column_spec(5, bold=TRUE)|>
    kableExtra::row_spec(1:3, bold=TRUE,
                         color='white', background='#D7261E')

```

> Ficamos com a mediana.

```{r mobilidade_populacional_mediana}

finalindicator.map(dat5.median,
                   title='Mobilidade Populacional')

```

## Suscetibilidade social

> - IDHM
> - Sem acesso a saneamento adequado

```{r suscetilidade_social,fig.width=10}

dat6.vars <- c("IDH-M",
               "Sem acesso ao saneamento adequado")

dat6.median <- indicator(temperatura, dat6.vars, index='median')
dat6.mean   <- indicator(temperatura, dat6.vars, index='mean')
dat6.pca    <- indicator(temperatura, dat6.vars, index='pca')|>
    dplyr::mutate(index=(1-index))

p1 <- indicator.map(dat6.median, title='Mediana')
p2 <- indicator.map(dat6.mean  , title='Média')
p3 <- indicator.map(dat6.pca   , title='PCA')

p1 + p2 + p3 +
    patchwork::plot_layout(guides='collect')&
    patchwork::plot_annotation(title='Suscetibilidade Social',
                               subtitle='Agregação por')&
    theme(plot.title   =element_text(face='bold', size=14),
          plot.subtitle=element_text(size=14))

dplyr::bind_rows(morans(dat6.median, dat6.median$index), 
                 morans(dat6.mean  , dat6.mean$index), 
                 morans(dat6.pca   , dat6.pca$index))|>
    dplyr::mutate(var=c('Mediana', 'Média', 'PCA'))|>
    dplyr::relocate(var, .before='Moran I statistic')|>
    kableExtra::kbl(booktabs=TRUE, digits=10)|>
    kableExtra::kable_classic_2(full_width=FALSE)|>
    kableExtra::column_spec(5, bold=TRUE)|>
    kableExtra::row_spec(1:3, bold=TRUE,
                         color='white', background='#D7261E')

```

> ficamos com a mediana.

```{r suscetibilidade_social_mediana}

finalindicator.map(dat6.median, title='Suscetibilidade Social')

```

# Nível 2

***

## Índice de Capacidade Adaptativa

> - Serviços de Saúde (mediana)

```{r indice_de_capacidade_adaptativa}

finalindicator.map(dat3.median,
                   title='Índice de Capacidade Adaptativa')

```

## Índice de sensibilidade

> - Suscetibilidade social (mediana)
> - Mobilidade Populacional (mediana)
> - Perfil Epidemiológico da Malária (PCA)

```{r indice_de_sensibilidade,fig.width=10}

dat8 <- tibble::tibble(ind1=dat4.pca   $index, 
                       ind2=dat5.median$index, 
                       ind3=dat6.median$index)

dat8.vars <- paste0('ind', 1:3)

dat8.median <- indicator(dat8, dat8.vars, index='median')
dat8.mean   <- indicator(dat8, dat8.vars, index='mean')
dat8.pca    <- indicator(dat8, dat8.vars, index='pca')

p1 <- indicator.map(dat8.median, title='Mediana')
p2 <- indicator.map(dat8.mean  , title='Média')
p3 <- indicator.map(dat8.pca   , title='PCA')

p1 + p2 + p3 +
    patchwork::plot_layout(guides='collect')&
    patchwork::plot_annotation(title='Índice de sensibilidade',
                               subtitle='Agregação por')&
    theme(plot.title   =element_text(face='bold', size=14),
          plot.subtitle=element_text(size=14))

dplyr::bind_rows(morans(dat8.median, dat8.median$index), 
                 morans(dat8.mean  , dat8.mean$index), 
                 morans(dat8.pca   , dat8.pca$index))|>
    dplyr::mutate(var=c('Mediana', 'Média', 'PCA'))|>
    dplyr::relocate(var, .before='Moran I statistic')|>
    kableExtra::kbl(booktabs=TRUE, digits=10)|>
    kableExtra::kable_classic_2(full_width=FALSE)|>
    kableExtra::column_spec(5, bold=TRUE)|>
    kableExtra::row_spec(1:3, bold=TRUE,
                         color='white', background='#D7261E')

```

> Ficamos com o PCA.

```{r indice_de_sensibilidade_pca}

finalindicator.map(dat8.pca, title='Índice de sensibilidade')

```

# Nível 3

***

## Índice de Exposição

> - Malha rodoviária
> - Uso e ocupação do solo (PCA)

```{r indice_de_exposicao,fig.width=10}

dat9 <- tibble::tibble(ind1=temperatura$`Presença de rodovias`, 
                       ind2=dat1.pca$index)

dat9.vars <- paste0('ind', 1:2)

dat9.median <- indicator(dat9, dat9.vars, index='median')
dat9.mean   <- indicator(dat9, dat9.vars, index='mean')
dat9.pca    <- indicator(dat9, dat9.vars, index='pca')

p1 <- indicator.map(dat9.median, title='Mediana')
p2 <- indicator.map(dat9.mean  , title='Média')
p3 <- indicator.map(dat9.pca   , title='PCA')

p1 + p2 + p3 +
    patchwork::plot_layout(guides='collect')&
    patchwork::plot_annotation(title='Índice de Exposição',
                               subtitle='Agregação por')&
    theme(plot.title   =element_text(face='bold', size=14),
          plot.subtitle=element_text(size=14))

dplyr::bind_rows(morans(dat9.median, dat9.median$index), 
                 morans(dat9.mean  , dat9.mean$index), 
                 morans(dat9.pca   , dat9.pca$index))|>
    dplyr::mutate(var=c('Mediana', 'Média', 'PCA'))|>
    dplyr::relocate(var, .before='Moran I statistic')|>
    kableExtra::kbl(booktabs=TRUE, digits=10)|>
    kableExtra::kable_classic_2(full_width=FALSE)|>
    kableExtra::column_spec(5, bold=TRUE)|>
    kableExtra::row_spec(1:3, bold=TRUE,
                         color='white', background='#D7261E')

```

> Ficamos com a mediana.

```{r indice_de_exposicao_mediana}

finalindicator.map(dat9.median, title='Índice de Exposição')

```

## Índice de Vulnerabilidade

> - Sensibilidade (PCA)
> - Capacidade adaptativa (mediana)

```{r indice_de_vulnerabilidade,fig.width=10}

dat10 <- tibble::tibble(ind1=dat3.median$index, 
                        ind2=dat8.pca$index)

dat10.vars <- paste0('ind', 1:2)

dat10.median <- indicator(dat10, dat10.vars, index='median')
dat10.mean   <- indicator(dat10, dat10.vars, index='mean')
dat10.pca    <- indicator(dat10, dat10.vars, index='pca')|>
    dplyr::mutate(index=(1-index))

p1 <- indicator.map(dat10.median, title='Mediana')
p2 <- indicator.map(dat10.mean  , title='Média')
p3 <- indicator.map(dat10.pca   , title='PCA')

p1 + p2 + p3 +
    patchwork::plot_layout(guides='collect')&
    patchwork::plot_annotation(title='Índice de Vulnerabilidade',
                               subtitle='Agregação por')&
    theme(plot.title   =element_text(face='bold', size=14),
          plot.subtitle=element_text(size=14))

dplyr::bind_rows(morans(dat10.median, dat10.median$index), 
                 morans(dat10.mean  , dat10.mean$index), 
                 morans(dat10.pca   , dat10.pca$index))|>
    dplyr::mutate(var=c('Mediana', 'Média', 'PCA'))|>
    dplyr::relocate(var, .before='Moran I statistic')|>
    kableExtra::kbl(booktabs=TRUE, digits=10)|>
    kableExtra::kable_classic_2(full_width=FALSE)|>
    kableExtra::column_spec(5, bold=TRUE)|>
    kableExtra::row_spec(1:3, bold=TRUE,
                         color='white', background='#D7261E')

```

> ficamos com a mediana.

```{r indice_de_vulnerabilidade_mediana}

finalindicator.map(dat10.median, title='Índice de Vulnerabilidade')

```

# Nível 4

***

## Índice de Risco de Impacto para temperatura

> - Vulnerabilidade (mediana)
> - Exposição (mediana)
> - Ameaça Climática

```{r indice_de_risco_de_impacto_para_temperatura,fig.width=10}

dat11 <- tibble::tibble(ind1=dat9.median$index, 
                        ind2=dat10.median$index,
                        ind3=temperatura$
                            `Índice de Ameaça Climática (Presente)`)

dat11.vars <- paste0('ind', 1:3)

dat11.median <- indicator(dat11, dat11.vars, index='median')
dat11.mean   <- indicator(dat11, dat11.vars, index='mean')
dat11.pca    <- indicator(dat11, dat11.vars, index='pca')|>
    dplyr::mutate(index=(1-index))

p1 <- indicator.map(dat11.median, title='Mediana')
p2 <- indicator.map(dat11.mean  , title='Média')
p3 <- indicator.map(dat11.pca   , title='PCA')

p1 + p2 + p3 +
    patchwork::plot_layout(guides='collect')&
    patchwork::plot_annotation(
                   title=
                       'Índice de Risco de Impacto para temperatura',
                   subtitle='Agregação por')&
    theme(plot.title   =element_text(face='bold', size=14),
          plot.subtitle=element_text(size=14))

dplyr::bind_rows(morans(dat11.median, dat11.median$index), 
                 morans(dat11.mean  , dat11.mean$index), 
                 morans(dat11.pca   , dat11.pca$index))|>
    dplyr::mutate(var=c('Mediana', 'Média', 'PCA'))|>
    dplyr::relocate(var, .before='Moran I statistic')|>
    kableExtra::kbl(booktabs=TRUE, digits=10)|>
    kableExtra::kable_classic_2(full_width=FALSE)|>
    kableExtra::column_spec(5, bold=TRUE)|>
    kableExtra::row_spec(1:3, bold=TRUE,
                         color='white', background='#D7261E')

```

> Ficamos com o PCA.

```{r indice_de_risco_de_impacto_para_temperatura_pca}

finalindicator.map(
    dat11.pca,
    title='Índice de Risco de Impacto para temperatura'
)

```

# Referência

***

> A análise estatística foi realizada no ambiente de computação
> estatística `R` (R Core Team, 2022). Os principais pacotes `R`
> utilizados foram o {`dplyr`} (Wickham et al., 2022), {`tidyr`}
> (Wickham & Girlich, 2022), {`rlang`} (Henry & Wickham, 2022),
> {`purrr`} (Henry & Wickham, 2020), {`ggplot2`} (Wickham, 2016),
> {`patckwork`} (Pedersen, 2020), {`geobr`} (Pereira & Gonçalves, 2022),
> e {`spdep`} (Bivand, 2022; Bivand et al., 2013).

> R Core Team (2022). R: A language and environment for statistical
> computing. R Foundation for Statistical Computing, Vienna,
> Austria. URL https://www.R-project.org/
>
> Wickham, H., François, R., Henry, L., Müller, K. (2022). dplyr: A
> Grammar of Data Manipulation. R package version
> 1.0.9. https://CRAN.R-project.org/package=dplyr
>
> Wickham, H., Girlich, M. (2022). tidyr: Tidy Messy Data. R package
> version 1.2.0, https://CRAN.R-project.org/package=tidyr
>
> Henry, L., Wickham, H. (2022). rlang: Functions for Base Types and
> Core R and 'Tidyverse' Features. R package version 1.0.2,
> https://CRAN.R-project.org/package=rlang
>
> Henry, L., Wickham, H. (2020). purrr: Functional Programming Tools. R
> package version 0.3.4, https://CRAN.R-project.org/package=purrr
>
> Wickham, H. (2016). ggplot2: Elegant Graphics for Data
> Analysis. Springer-Verlag New York
>
> Pedersen, T. L. (2020). patchwork: The Composer of Plots. R package
> version 1.1.1. https://CRAN.R-project.org/package=patchwork
>
> Pereira, R. H. M., Gonçalves, C. N. (2022). geobr: Download Official
> Spatial Data Sets of Brazil. R package version 1.6.5999,
> <https://github.com/ipeaGIT/geobr
>
> Bivand, R. S. (2022) R Packages for Analyzing Spatial Data: A Comparative
> Case Study with Areal Data Geographical Analysis URL
> https://doi.org/10.1111/gean.12319
>
> Bivand, R. S., Pebesma, E., Gomez-Rubio, V. (2013). Applied spatial
> data analysis with R, Second edition. Springer,
> NY. https://asdar-book.org/
